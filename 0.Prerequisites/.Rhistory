View(X1)
X1 <- X1 %>% mutate(ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), "OM", NA)
)
# Primary diet based on predominant food items
Elton_mammals <- Elton_mammals %>%
mutate(ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), "OM", ifelse(Diet.Fruit>50, "NE|FR",
ifelse(Diet.Nect>50, "NE|FR",
ifelse(Diet.PlantO>50, "PL|SE",
ifelse(Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", NA))))))) )
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton_mammals <- Elton_mammals %>%
mutate(ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), # cases where all below 50
"OM", ifelse(Diet.Fruit>50 | Diet.Nect>50, "NE|FR",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE"))))))))))))
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton_mammals <- Elton_mammals %>%
mutate(ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), # cases where all below 50
"OM", ifelse(Diet.Fruit>50 | Diet.Nect>50, "NE|FR",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE", NA))))))))))))
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton_mammals <- Elton_mammals %>%
mutate(Primary_diet=ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), # cases where all below 50
"OM", ifelse(Diet.Fruit>50 | Diet.Nect>50, "NE|FR",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "NE|FR",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE", NA))))))))))))
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton_mammals <- Elton_mammals %>%
mutate(Primary_diet=ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), # cases where all below 50
"OM", ifelse(Diet.Fruit>50 | Diet.Nect>50, "FR|NE",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE",
ifelse(Diet.Fruit==50 & Diet.Nect==50, "FR|NE",
ifelse(Diet.PlantO==50 & Diet.Seed==50, "PL|SE", "OM"))))))))))))))
X<- subset(Elton_mammals, Primary_diet=="OM")
View(X)
## Process Diet information from Kissling (Mammals) ("MammalDiet"), Amphibio (Amphibians) and Elton traits (Birds and mammals)
## Sekercioglu not used
## Adopting a binary classification for food items. The variables are: VE, IN, FR, SE, PL, NE, SCV
## Define 5 categories:
# 1: plant/seed
# 2: fruit/nectar
# 3: vertebrates (includes carrion)
# 4: invertebrates
# 5: omnivores
## Preamble
X <- c("data.table", "plyr", "dplyr", "tidyr", "magrittr", "reshape", "reshape2", "stringr", "stringi")
invisible(lapply(X, library, character.only=TRUE)); rm(X)
`%nin%` = Negate(`%in%`)
# Corrected data
MammalDIET_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/MammalDIET.csv")
Amphibio_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Amphibio.csv")
Elton_birds_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_birds.csv")
Elton_mammals_C <-  read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_mammals.csv")
# Uncorrected data
Amphibio_UN <- read.csv("../../Data/Amphibians/AmphiBIO_v1.csv")
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
Elton_mammals_UN <-  read.csv("../../Data/Mammals/EltonTraits_Mammals.csv")
## Put mammalian diet information together
Kissling <- read.csv("../../Data/Mammals/Kissling_Mammal_diet_2014.csv", sep=",")
Kissling$Binomial_name <- paste(Kissling$Genus, Kissling$Species, sep=" ")
Kissling <- subset(Kissling, Binomial_name != "Mico sp. nov.")
Kissling <- Kissling %>% select(-TaxonID, -TaxonomicNote, -FillCode)
Kissling <- Kissling[, c(28, 1:27)]
MammalDIET2 <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET2.csv")[, c(1:28)]
colnames(MammalDIET2)[28] <- "DataSource"
MammalDIET2_supp <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET_2_supp.csv")
MammalDIET2_supp$TrophicLevel %<>% as.character()
MammalDIET2_supp <- MammalDIET2_supp %>%
mutate(TrophicLevel=ifelse(TrophicLevel %in% c("Carnivore", "Omnivore", "Herbivore"), TrophicLevel, NA)) %>%
filter(!is.na(TrophicLevel)) %>%
mutate(Mammal=ifelse(Mammal %in% c(0:3), Mammal, NA)) %>%
mutate(MammalEater=ifelse(MammalEater %in% c(0:3), MammalEater, NA)) %>%
mutate(Insectivore=ifelse(Insectivore %in% c(0:3), Insectivore, NA))%>%
mutate(Frugivore=ifelse(Frugivore %in% c(0:3), Frugivore, NA))%>%
mutate(Granivore=ifelse(Granivore %in% c(0:3), Granivore, NA)) %>%
mutate(Folivore=ifelse(Folivore %in% c(0:3), Folivore, NA))
MammalDIET2_supp[, c(6:27)] %<>% droplevels()
MammalDIET2 <- rbind(MammalDIET2, MammalDIET2_supp)
MammalDIET2$Binomial <- as.character(MammalDIET2$Binomial)
MammalDIET2$Binomial[MammalDIET2$Binomial=="Rhinolophus hildebrandtii"] <- "Rhinolophus hildebrandti"
MammalDIET2$Binomial[MammalDIET2$Binomial=="Tadarida bivittatus"] <- "Tadarida bivittata"
colnames(MammalDIET2)[1] <- "Binomial_name"
Y <- intersect(MammalDIET2$Binomial_name, Kissling$Binomial_name)
Kissling <- Kissling %>% filter(Binomial_name %nin% Y)
MammalDIET_UN <- rbind(Kissling, MammalDIET2) # dataset to use
rm(Kissling, MammalDIET2, MammalDIET2_supp)
rm(Kissling, MammalDIET2, MammalDIET2_supp, Y)
View(Amphibio_C)
AmphiData=Amphibio_C
colnames(AmphiData)[c(10:15)] <- c("PL", "NE", "SE", "FR", "IN", "VE")
apply(AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")], 1, sum, na.rm=T)
# Diet breadth
AmphiData$Diet_breadth <- apply(AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")], 1, sum, na.rm=T)
AmphiData$Diet_breadth[AmphiData$Diet_breadth==0] <- NA
# Trophic levels and primary diet
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==0), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore", NA))))
View(AmphiData)
# Trophic levels and primary diet
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==1), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore", NA))))
# Trophic levels and primary diet
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==1), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0 & IN==0 & VE==0), NA, Trophic_level)))))
AmphiData <- AmphiData %>%
mutate_at(.vars = vars(PL, NE, SE, FR, IN, VE),
.funs = funs(ifelse(1, ., 0)))
AmphiData=Amphibio_C
Func <- function(X) {ifelse(X==1, 0, NA)}
# Food items as binary variables (0 or 1)
colnames(AmphiData)[c(10:15)] <- c("PL", "NE", "SE", "FR", "IN", "VE")
AmphiData <- AmphiData %>%
mutate_at(.vars = vars(PL, NE, SE, FR, IN, VE),
.funs = Func)
AmphiData = Amphibio_C
# Food items as binary variables (0 or 1)
colnames(AmphiData)[c(10:15)] <- c("PL", "NE", "SE", "FR", "IN", "VE")
Func <- function(X) {ifelse(X==1, 1, 0)}
AmphiData[c(1:10), c(10:15)]
AmphiData <- AmphiData %>%
mutate_at(.vars = vars(PL, NE, SE, FR, IN, VE),
.funs = Func)
AmphiData[c(1:10), c(10:15)]
Func <- function(X) {ifelse(is.na(X), 0, 1)}
AmphiData <- AmphiData %>%
mutate_at(.vars = vars(PL, NE, SE, FR, IN, VE),
.funs = Func)
AmphiData[c(1:10), c(10:15)]
# Diet breadth
AmphiData$Diet_breadth <- apply(AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")], 1, sum, na.rm=T)
AmphiData$Diet_breadth[AmphiData$Diet_breadth==0] <- NA
AmphiData$Diet_breadth
# Trophic levels and primary diet
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==1), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0 & IN==0 & VE==0), NA, Trophic_level)))))
# Trophic levels and primary diet
AmphiData$Trophic_level <- NA
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==1), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0 & IN==0 & VE==0), NA, Trophic_level)))))
AmphiData[c(1:20), c(10:15,41 )]
AmphiData[c(156:494), c(10:15,41 )]
# Primary diet
AmphiData$Primary_diet <- NA
AmphiData <- AmphiData %>%
mutate(Primary_diet=paste(colnames(AmphiData[AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")]==1]), sep="|"))
AmphiData <- AmphiData %>%
mutate(Primary_diet=paste(colnames(AmphiData[,AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")]==1]), sep="|"))
AmphiData <- AmphiData %>%
mutate(Primary_diet=ifelse((PL==1|SE==1) & (NE==0 & FR==0 & IN==0 & VE==0), "PL|SE",
ifelse((FR==1|NE==1) & (PL==0 & SE==0 & IN==0 & VE==0), "FR|NE",
ifelse(VE==1 & (PL==0 & SE==0 & NE==0 & FR==0 & IN==0), "VE",
ifelse(IN==1 & (PL==0 & SE==0 & NE==0 & FR==0 & VE==0), "IN",
ifelse(IN==0 & PL==0 & SE==0 & NE==0 & FR==0 & VE==0, NA, "OM"))))))
View(AmphiData)
AmphiData[c(258:321), c(10:15,41,42 )]
unique(Amphibio$Primary_diet)
colnames(Amphibio_UN)[5]
Amphibio_C <- For.Amphibio(Amphibio_C)
For.Amphibio <- function(AmphiData) {
Func <- function(X) {ifelse(is.na(X), 0, 1)}
# Food items as binary variables (0 or 1)
colnames(AmphiData)[c(10:15)] <- c("PL", "NE", "SE", "FR", "IN", "VE")
AmphiData <- AmphiData %>%
mutate_at(.vars = vars(PL, NE, SE, FR, IN, VE),
.funs = Func)
# Diet breadth
AmphiData$Diet_breadth <- apply(AmphiData[, c("PL", "NE", "SE", "FR", "IN", "VE")], 1, sum, na.rm=T)
AmphiData$Diet_breadth[AmphiData$Diet_breadth==0] <- NA
# Trophic levels
AmphiData$Trophic_level <- NA
AmphiData <- AmphiData %>%
mutate(Trophic_level=ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==0 & VE==0), "Herbivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0) & (IN==1|VE==1), "Carnivore",
ifelse( (PL==1|NE==1|SE==1|FR==1) & (IN==1| VE==1), "Omnivore",
ifelse( (PL==0 & NE==0 & SE==0 & FR==0 & IN==0 & VE==0), NA, Trophic_level)))))
# Primary diet
AmphiData$Primary_diet <- NA
AmphiData <- AmphiData %>%
mutate(Primary_diet=ifelse((PL==1|SE==1) & (NE==0 & FR==0 & IN==0 & VE==0), "PL|SE",
ifelse((FR==1|NE==1) & (PL==0 & SE==0 & IN==0 & VE==0), "FR|NE",
ifelse(VE==1 & (PL==0 & SE==0 & NE==0 & FR==0 & IN==0), "VE",
ifelse(IN==1 & (PL==0 & SE==0 & NE==0 & FR==0 & VE==0), "IN",
ifelse(IN==0 & PL==0 & SE==0 & NE==0 & FR==0 & VE==0, NA, "OM"))))))
}
Amphibio_C <- For.Amphibio(Amphibio_C)
Amphibio_UN <- For.Amphibio(Amphibio_UN)
View(Amphibio_UN)
View(Amphibio_C)
MammalDiet = MammalDIET_C
# Create diet binary variables
MammalDiet <- MammalDiet %>%
mutate(VE=ifelse(any(c(Vertebrate, Mammal, Bird, Herptile, Fish)==1, na.rm=TRUE), 1, 0))
View(MammalDiet)
unique(MammalDIET_C$TrophicLevel)
unique(MammalDIET_UN$TrophicLevel)
# Correct
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel =ifelse(NotAssigned, NA, TrophicLevel)) %>%
mutate(TrophicLevel=droplevels(TrophicLevel))
# Correct
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel =ifelse(TrophicLevel==NotAssigned, NA, TrophicLevel)) %>%
mutate(TrophicLevel=droplevels(TrophicLevel))
# Correct
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel=ifelse(TrophicLevel==NotAssigned, NA, TrophicLevel)) %>%
mutate(TrophicLevel=droplevels(TrophicLevel))
# Correct
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel=ifelse(TrophicLevel=="NotAssigned", NA, TrophicLevel)) %>%
mutate(TrophicLevel=droplevels(TrophicLevel))
# Correct
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel=ifelse(TrophicLevel=="NotAssigned", NA, TrophicLevel))
unique(MammalDiet$TrophicLevel)
MammalDiet=MammalDIET_C
# Correct
MammalDiet$TrophicLevel <- as.character(MammalDiet$TrophicLevel)
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel=ifelse(TrophicLevel=="NotAssigned", NA, TrophicLevel))
unique(MammalDiet$TrophicLevel)
# Correct
MammalDiet[MammalDiet=="Could not find data"]
# Correct
MammalDiet[MammalDiet=="Could not find data"] <- NA
View(MammalDIET_C)
# Create diet binary variables
MammalDiet <- MammalDiet %>%
mutate(VE=ifelse(Vertebrate==1|Mammal==1|Bird==1|Herptile==1|Fish==1, 1, 0))
# Create diet binary variables
MammalDiet <- MammalDiet %>%
mutate(VE=ifelse(Vertebrate==1|Mammal==1|Bird==1|Herptile==1|Fish==1, 1, 0))
# Create diet binary variables
MammalDiet <- MammalDiet %>%
mutate(VE=ifelse(Vertebrate==1|Mammal==1|Bird==1|Herptile==1|Fish==1, 1, 0)) %>%
mutate(IN=ifelse(Invertebrate==1, 1, 0)) %>%
mutate(SE=ifelse(Seed==1, 1, 0)) %>%
mutate(FR=ifelse(Fruit==1, 1, 0)) %>%
mutate(NE=ifelse(Nectar==1, 1, 0)) %>%
mutate(PL=ifelse((Plant==1 & Seed==0 & Fruit==0 & Nectar==0)|Root==1|Leaf==1|Woody==1|Herbaceous==1, 1, 0))
For.MammalDiet <- function(MammalDiet) {
# Correct
MammalDiet[MammalDiet=="Could not find data"] <- NA
MammalDiet$TrophicLevel <- as.character(MammalDiet$TrophicLevel)
MammalDiet <- MammalDiet %>%
mutate(TrophicLevel=ifelse(TrophicLevel=="NotAssigned", NA, TrophicLevel))
# Create diet binary variables
MammalDiet <- MammalDiet %>%
mutate(VE=ifelse(Vertebrate==1|Mammal==1|Bird==1|Herptile==1|Fish==1, 1, 0)) %>%
mutate(IN=ifelse(Invertebrate==1, 1, 0)) %>%
mutate(SE=ifelse(Seed==1, 1, 0)) %>%
mutate(FR=ifelse(Fruit==1, 1, 0)) %>%
mutate(NE=ifelse(Nectar==1, 1, 0)) %>%
mutate(PL=ifelse((Plant==1 & Seed==0 & Fruit==0 & Nectar==0)|Root==1|Leaf==1|Woody==1|Herbaceous==1, 1, 0))
# Diet breadth
MammalDiet$Diet_breadth <- apply(MammalDiet[, c("PL", "NE", "SE", "FR", "IN", "VE")], 1, sum, na.rm=T)
MammalDiet$Diet_breadth[MammalDiet$Diet_breadth==0] <- NA
# Primary diet
MammalDiet$Primary_diet <- NA
MammalDiet <- MammalDiet %>%
mutate(Primary_diet=ifelse((PL==1|SE==1) & (NE==0 & FR==0 & IN==0 & VE==0), "PL|SE",
ifelse((FR==1|NE==1) & (PL==0 & SE==0 & IN==0 & VE==0), "FR|NE",
ifelse(VE==1 & (PL==0 & SE==0 & NE==0 & FR==0 & IN==0), "VE",
ifelse(IN==1 & (PL==0 & SE==0 & NE==0 & FR==0 & VE==0), "IN",
ifelse(IN==0 & PL==0 & SE==0 & NE==0 & FR==0 & VE==0, NA, "OM"))))))
return(MammalDiet)
}
MammalDIET_C <- For.MammalDiet(MammalDIET_C)
MammalDIET_UN <- For.MammalDiet(MammalDIET_UN)
View(MammalDIET_C)
Elton =Elton_mammals_C
# Vertebrate items as one
Elton$Diet.Vert <- Elton$Diet.Vend + Elton$Diet.Vect + Elton$Diet.Vfish + Elton$Diet.Vunk + Elton$Diet.Scav
Elton <- Elton %>%
select(-Diet.Vect, -Diet.Vend, -Diet.Vunk, -Diet.Vfish, -Diet.Scav)
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton <- Elton %>%
mutate(Primary_diet=ifelse( (Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), "OM",  # cases where all below 50
ifelse(Diet.Fruit>50 | Diet.Nect>50, "FR|NE",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE",
ifelse(Diet.Fruit==50 & Diet.Nect==50, "FR|NE",
ifelse(Diet.PlantO==50 & Diet.Seed==50, "PL|SE", "OM"))))))))))))))
View(Elton)
View(Elton_birds_C)
Elton.Mammals <- function(Elton) {
# Vertebrate items as one
Elton$Diet.Vert <- Elton$Diet.Vend + Elton$Diet.Vect + Elton$Diet.Vfish + Elton$Diet.Vunk + Elton$Diet.Scav
Elton <- Elton %>%
select(-Diet.Vect, -Diet.Vend, -Diet.Vunk, -Diet.Vfish, -Diet.Scav)
# Primary diet based on predominant food items (here, cases where all < 50 or one >50)
Elton <- Elton %>%
mutate(Diet.5Cat=ifelse((Diet.Fruit<50 & Diet.Inv<50 & Diet.Nect<50 & Diet.Seed<50 & Diet.PlantO<50 & Diet.Vert <50), "OM",  # cases where all below 50
ifelse(Diet.Fruit>50 | Diet.Nect>50, "FR|NE",
ifelse(Diet.PlantO>50 | Diet.Seed>50, "PL|SE",
ifelse(Diet.Vert>50, "VE",
ifelse(Diet.Inv>50, "IN", # cases where one above 50 and then cases where one equals 50
ifelse(Diet.Fruit==50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect==50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "FR|NE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv==50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert<50, "IN",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO==50 & Diet.Seed<50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed==50 & Diet.Vert<50, "PL|SE",
ifelse(Diet.Fruit<50 & Diet.Nect<50 & Diet.Inv <50 & Diet.PlantO <50 & Diet.Seed<50 & Diet.Vert==50, "VE",
ifelse(Diet.Fruit==50 & Diet.Nect==50, "FR|NE",
ifelse(Diet.PlantO==50 & Diet.Seed==50, "PL|SE", "OM"))))))))))))))
return(Elton)
}
Elton_mammals_UN <- Elton.Mammals(Elton_mammals_UN)
# Change column name of primary diet
colnames(Elton)[colnames(Elton)=="Diet.5Cat"]
colnames(Elton)
Elton_mammals_C <-  read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_mammals.csv")
Elton_mammals_UN <-  read.csv("../../Data/Mammals/EltonTraits_Mammals.csv")
Elton_mammals_C <- Elton.Mammals(Elton_mammals_C)
Elton_mammals_UN <- Elton.Mammals(Elton_mammals_UN)
Elton=Elton_mammals_C
colnames(Elton)[colnames(Elton)=="Diet.5Cat"]
# Change column name of primary diet
colnames(Elton)[colnames(Elton)=="Diet.5Cat"] <- "Primary_diet"
colnames(Elton)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/0.Prerequisites/0.7.Process_diet_information.R', echo=TRUE)
X <- c("data.table", "plyr", "dplyr", "tidyr", "magrittr", "reshape", "reshape2", "stringr", "stringi")
invisible(lapply(X, library, character.only=TRUE)); rm(X)
`%nin%` = Negate(`%in%`)
# Corrected data
MammalDIET_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/MammalDIET.csv")
Amphibio_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Amphibio.csv")
Elton_birds_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_birds.csv")
Elton_mammals_C <-  read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_mammals.csv")
# Uncorrected data
Amphibio_UN <- read.csv("../../Data/Amphibians/AmphiBIO_v1.csv")
colnames(Amphibio_UN)[5] <- "Best_guess_binomial"
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
Elton_mammals_UN <-  read.csv("../../Data/Mammals/EltonTraits_Mammals.csv")
# Put mammalian diet information together
Kissling <- read.csv("../../Data/Mammals/Kissling_Mammal_diet_2014.csv", sep=",")
Kissling$Binomial_name <- paste(Kissling$Genus, Kissling$Species, sep=" ")
Kissling <- subset(Kissling, Binomial_name != "Mico sp. nov.")
Kissling <- Kissling %>% select(-TaxonID, -TaxonomicNote, -FillCode)
Kissling <- Kissling[, c(28, 1:27)]
MammalDIET2 <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET2.csv")[, c(1:28)]
colnames(MammalDIET2)[28] <- "DataSource"
MammalDIET2_supp <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET_2_supp.csv")
MammalDIET2_supp$TrophicLevel %<>% as.character()
MammalDIET2_supp <- MammalDIET2_supp %>%
mutate(TrophicLevel=ifelse(TrophicLevel %in% c("Carnivore", "Omnivore", "Herbivore"), TrophicLevel, NA)) %>%
filter(!is.na(TrophicLevel)) %>%
mutate(Mammal=ifelse(Mammal %in% c(0:3), Mammal, NA)) %>%
mutate(MammalEater=ifelse(MammalEater %in% c(0:3), MammalEater, NA)) %>%
mutate(Insectivore=ifelse(Insectivore %in% c(0:3), Insectivore, NA))%>%
mutate(Frugivore=ifelse(Frugivore %in% c(0:3), Frugivore, NA))%>%
mutate(Granivore=ifelse(Granivore %in% c(0:3), Granivore, NA)) %>%
mutate(Folivore=ifelse(Folivore %in% c(0:3), Folivore, NA))
MammalDIET2_supp[, c(6:27)] %<>% droplevels()
MammalDIET2 <- rbind(MammalDIET2, MammalDIET2_supp)
MammalDIET2$Binomial <- as.character(MammalDIET2$Binomial)
MammalDIET2$Binomial[MammalDIET2$Binomial=="Rhinolophus hildebrandtii"] <- "Rhinolophus hildebrandti"
MammalDIET2$Binomial[MammalDIET2$Binomial=="Tadarida bivittatus"] <- "Tadarida bivittata"
colnames(MammalDIET2)[1] <- "Binomial_name"
Y <- intersect(MammalDIET2$Binomial_name, Kissling$Binomial_name)
Kissling <- Kissling %>% filter(Binomial_name %nin% Y)
MammalDIET_UN <- rbind(Kissling, MammalDIET2) # dataset to use
rm(Kissling, MammalDIET2, MammalDIET2_supp, Y)
unique(Elton_birds_C$Diet.5Cat)
unique(Elton_mammals_C$Diet.5Cat)
unique(Elton_mammal_C$Diet.5Cat)
unique(Elton_mammals_C$Diet.5Cat)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/0.Prerequisites/0.7.Process_diet_information.R', echo=TRUE)
unique(Elton_mammals_C$Primary_diet)
unique(Elton_mammals_UN$Primary_diet)
View(Elton_birds_C)
Elton_birds_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_birds.csv")
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
unique(Elton_birds_C$Diet.5Cat)
unique(Amphibio_C$Primary_diet)
unique(Elton_mammals_C$Primary_diet)
## Change Diet.5Cat in Elton birds
Elton_birds_C <- Elton_birds_C %>%
mutate(Diet.5Cat=ifelse(Diet.5Cat=="PlantSeed", "PL|SE",
ifelse(Diet.5Cat=="Omnivore", "OM",
ifelse(Diet.5Cat=="FruiNect", "FR|NE",
ifelse(Diet.5Cat=="Invertebrate", "IN",
ifelse(Diet.5Cat=="VertFishScav", "VE", NA))))))
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
Elton_birds_UN <- Elton_birds_C %>%
mutate(Diet.5Cat=ifelse(Diet.5Cat=="PlantSeed", "PL|SE",
ifelse(Diet.5Cat=="Omnivore", "OM",
ifelse(Diet.5Cat=="FruiNect", "FR|NE",
ifelse(Diet.5Cat=="Invertebrate", "IN",
ifelse(Diet.5Cat=="VertFishScav", "VE", NA))))))
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/0.Prerequisites/0.7.Process_diet_information.R', echo=TRUE)
Elton_birds_C$Primary_diet
Elton_birds_UN$Primary_diet
Elton_birds_UN$Primary_diet
View(Elton_birds_UN)
Elton_mammals_C$Primary_diet
Elton_mammals_UN$Primary_diet
X <- c("data.table", "plyr", "dplyr", "tidyr", "magrittr", "reshape", "reshape2", "stringr", "stringi")
invisible(lapply(X, library, character.only=TRUE)); rm(X)
`%nin%` = Negate(`%in%`)
# Corrected data
MammalDIET_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/MammalDIET.csv")
Amphibio_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Amphibio.csv")
Elton_birds_C <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_birds.csv")
Elton_mammals_C <-  read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Elton_mammals.csv")
# Uncorrected data
Amphibio_UN <- read.csv("../../Data/Amphibians/AmphiBIO_v1.csv")
colnames(Amphibio_UN)[5] <- "Best_guess_binomial"
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
Elton_mammals_UN <-  read.csv("../../Data/Mammals/EltonTraits_Mammals.csv")
## Change Diet.5Cat in Elton birds
Elton_birds_C <- Elton_birds_C %>%
mutate(Diet.5Cat=ifelse(Diet.5Cat=="PlantSeed", "PL|SE",
ifelse(Diet.5Cat=="Omnivore", "OM",
ifelse(Diet.5Cat=="FruiNect", "FR|NE",
ifelse(Diet.5Cat=="Invertebrate", "IN",
ifelse(Diet.5Cat=="VertFishScav", "VE", NA))))))
Elton_birds_UN <- Elton_birds_C %>%
mutate(Diet.5Cat=ifelse(Diet.5Cat=="PlantSeed", "PL|SE",
ifelse(Diet.5Cat=="Omnivore", "OM",
ifelse(Diet.5Cat=="FruiNect", "FR|NE",
ifelse(Diet.5Cat=="Invertebrate", "IN",
ifelse(Diet.5Cat=="VertFishScav", "VE", NA))))))
# Put mammalian diet information together
Kissling <- read.csv("../../Data/Mammals/Kissling_Mammal_diet_2014.csv", sep=",")
Kissling$Binomial_name <- paste(Kissling$Genus, Kissling$Species, sep=" ")
Kissling <- subset(Kissling, Binomial_name != "Mico sp. nov.")
Kissling <- Kissling %>% select(-TaxonID, -TaxonomicNote, -FillCode)
Kissling <- Kissling[, c(28, 1:27)]
MammalDIET2 <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET2.csv")[, c(1:28)]
colnames(MammalDIET2)[28] <- "DataSource"
MammalDIET2_supp <- read.csv("../../Data/Mammals/MammalDIET_2/MammalDIET_2_supp.csv")
MammalDIET2_supp$TrophicLevel %<>% as.character()
MammalDIET2_supp <- MammalDIET2_supp %>%
mutate(TrophicLevel=ifelse(TrophicLevel %in% c("Carnivore", "Omnivore", "Herbivore"), TrophicLevel, NA)) %>%
filter(!is.na(TrophicLevel)) %>%
mutate(Mammal=ifelse(Mammal %in% c(0:3), Mammal, NA)) %>%
mutate(MammalEater=ifelse(MammalEater %in% c(0:3), MammalEater, NA)) %>%
mutate(Insectivore=ifelse(Insectivore %in% c(0:3), Insectivore, NA))%>%
mutate(Frugivore=ifelse(Frugivore %in% c(0:3), Frugivore, NA))%>%
mutate(Granivore=ifelse(Granivore %in% c(0:3), Granivore, NA)) %>%
mutate(Folivore=ifelse(Folivore %in% c(0:3), Folivore, NA))
MammalDIET2_supp[, c(6:27)] %<>% droplevels()
MammalDIET2 <- rbind(MammalDIET2, MammalDIET2_supp)
MammalDIET2$Binomial <- as.character(MammalDIET2$Binomial)
MammalDIET2$Binomial[MammalDIET2$Binomial=="Rhinolophus hildebrandtii"] <- "Rhinolophus hildebrandti"
MammalDIET2$Binomial[MammalDIET2$Binomial=="Tadarida bivittatus"] <- "Tadarida bivittata"
colnames(MammalDIET2)[1] <- "Binomial_name"
Y <- intersect(MammalDIET2$Binomial_name, Kissling$Binomial_name)
Kissling <- Kissling %>% filter(Binomial_name %nin% Y)
MammalDIET_UN <- rbind(Kissling, MammalDIET2) # dataset to use
rm(Kissling, MammalDIET2, MammalDIET2_supp, Y)
View(Elton_birds_UN)
Elton_birds_UN <- read.csv("../../Data/Birds/EltonTraits_Birds.csv")
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/0.Prerequisites/0.7.Process_diet_information.R', echo=TRUE)
Elton_birds_UN$Primary_diet
View(Elton_birds_C)
Elton_birds_C[Elton_birds_C$Best_guess_binomial=="Acanthagenys rufogularis"]
Elton_birds_C[Elton_birds_C$Best_guess_binomial=="Acanthagenys rufogularis",]
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/0.Prerequisites/0.7.Process_diet_information.R', echo=TRUE)
