Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne|Ramanella", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne|Ramanella|Metaphrynella", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Uperodon taprobanicus (Kaloula pulchra, Kaloula taprobanica)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Kaloula pulchra|Kaloula taprobanica", PhyloAmphibian_UN$tip.label)],"Uperodon taprobanicus")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Uperodon <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne|Ramanella|Metaphrynella", PhyloAmphibian_UN$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Uperodon$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Uperodon <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne|Ramanella|Metaphrynella", Phylo_Amphibians$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Uperodon <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Uperodon|Kaloula|Rhombophryne|Ramanella|Metaphrynella", Phylo_Amphibians.final$tip.label)])
Uperodon$tip.label <- paste(paste(substr(Uperodon$tip.label, 1,2), ".", sep=""), word(Uperodon$tip.label, 2), sep=" ")
plot(Uperodon,tip.color=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Uperodon$tip.label %in% "Up. taprobanicus", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
Reps
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes lepidus|Petinomys|Sciurus sagitta|Pteromys lepidus",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes|Petinomys|Sciurus|Pteromys",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus", PhyloMammal_UN$tip.label)])
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Reps
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes lepidus|Petinomys sagitta|Sciurus sagitta|Pteromys lepidus",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Kaloula|Rhombophryne|Ramanella|Metaphrynella", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys|Sciurus|Pteromys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
source('~/.active-rstudio-document', echo=TRUE)
dev.off()
## 3: Case study where the dropped tip is chosen randomly; problematic cases when replicated tips are not sister clades
# Hylopetes taprobanicus (Kaloula pulchra, Kaloula taprobanica)
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case3.pdf", width=8, height=5, family="Times", pointsize=14)
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes lepidus|Petinomys sagitta",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
DroppedAmphibians
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Ambystoma californiense|Ambystoma tigrinum", PhyloAmphibian_UN$tip.label)],"Ambystoma californiense")
Reps
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
Reps
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Up. taprobanicus", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Up. taprobanicus", 4,3), main="B. Corrected", node.depth=2)
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma|Kaloula|Rhombophryne|Ramanella|Metaphrynella", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="C. After removing replicated tips", node.depth=2)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Ambystoma californiense|Ambystoma tigrinum", PhyloAmphibian_UN$tip.label)],"Ambystoma californiense")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case2.pdf", width=8, height=5, family="Times", pointsize=14)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Ambystoma californiense|Ambystoma tigrinum", PhyloAmphibian_UN$tip.label)],"Ambystoma californiense")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case2.pdf", width=8, height=5, family="Times", pointsize=14)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Ambystoma californiense|Ambystoma tigrinum", PhyloAmphibian_UN$tip.label)],"Ambystoma californiense")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
Reps <- c(PhyloReptile_UN$tip.label[grepl("Phrynocephalus przewalskii", PhyloReptile_UN$tip.label)],"Phrynocephalus przewalskii")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case1.pdf", width=8, height=5, family="Times", pointsize=14)
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Phrynocephalus <- drop.tip(PhyloReptile_UN, PhyloReptile_UN$tip.label[!grepl("Phrynocephalus", PhyloReptile_UN$tip.label)])
Phrynocephalus$tip.label <- paste(paste(substr(Phrynocephalus$tip.label, 1,2), ".", sep=""), word(Phrynocephalus$tip.label, 2), sep=" ")
plot(Phrynocephalus,tip.color=ifelse(Phrynocephalus$tip.label %in% Reps, "blue",
ifelse(Phrynocephalus$tip.label %in% c("Ph. werneri", "Ph. potanini", "Ph. affinis", "Ph. elegans",
"Ph. frontalis", "Ph. parvulus", "Ph. birulai", " Ph. suschkinianus"),
"red", "black")),
cex=1.2, label.offset=1,
font=ifelse(Phrynocephalus$tip.label %in% Reps, 4,
ifelse(Phrynocephalus$tip.label %in% c("Ph. werneri", "Ph. potanini", "Ph. affinis", "Ph. elegans",
"Ph. frontalis", "Ph. parvulus", "Ph. birulai", " Ph. suschkinianus"), 4,3)), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Phrynocephalus <- drop.tip(Phylo_Reptiles, Phylo_Reptiles$tip.label[!grepl("Phrynocephalus", Phylo_Reptiles$tip.label)])
Phrynocephalus$tip.label <- paste(paste(substr(Phrynocephalus$tip.label, 1,2), ".", sep=""), word(Phrynocephalus$tip.label, 2), sep=" ")
plot(Phrynocephalus,tip.color=ifelse(Phrynocephalus$tip.label %in% "Ph. przewalskii", "blue","black"), cex=1.2, adj=0, label.offset=1,
font=ifelse(Phrynocephalus$tip.label %in% "Ph. przewalskii", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Phrynocephalus <- drop.tip(Phylo_Reptiles.final, Phylo_Reptiles.final$tip.label[!grepl("Phrynocephalus|Ramanella|Kaloula|Metaphrynella|Rhombophryne", Phylo_Reptiles.final$tip.label)])
Phrynocephalus$tip.label <- paste(paste(substr(Phrynocephalus$tip.label, 1,2), ".", sep=""), word(Phrynocephalus$tip.label, 2), sep=" ")
plot(Phrynocephalus,tip.color=ifelse(Phrynocephalus$tip.label %in% "Ph. przewalskii", "blue","black"), cex=1.2, adj=0, label.offset=1,
font=ifelse(Phrynocephalus$tip.label %in% "Ph. przewalskii", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
## Case 2: not sister clades but the tip labels figures in the original tre
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case2.pdf", width=8, height=5, family="Times", pointsize=14)
Reps <- c(PhyloAmphibian_UN$tip.label[grepl("Ambystoma californiense|Ambystoma tigrinum", PhyloAmphibian_UN$tip.label)],"Ambystoma californiense")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Ambystoma <- drop.tip(PhyloAmphibian_UN, PhyloAmphibian_UN$tip.label[!grepl("Ambystoma", PhyloAmphibian_UN$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Ambystoma <- drop.tip(Phylo_Amphibians, Phylo_Amphibians$tip.label[!grepl("Ambystoma", Phylo_Amphibians$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Ambystoma <- drop.tip(Phylo_Amphibians.final, Phylo_Amphibians.final$tip.label[!grepl("Ambystoma", Phylo_Amphibians.final$tip.label)])
Ambystoma$tip.label <- paste(paste(substr(Ambystoma$tip.label, 1,2), ".", sep=""), word(Ambystoma$tip.label, 2), sep=" ")
plot(Ambystoma,tip.color=ifelse(Ambystoma$tip.label %in% "Am. californiense", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Ambystoma$tip.label %in% "Am. tigrinum", 4,ifelse(Ambystoma$tip.label %in% c("Am. californiense"), 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="C. After removing replicated tips", node.depth=2)
box("outer")
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,3), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,ifelse(Hylopetes$tip.label %in% "Hy. sagitta", 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,ifelse(Hylopetes$tip.label %in% "Hy. sagitta", 4, 3)), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,ifelse(Hylopetes$tip.label %in% "Hy. sagitta", 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
pdf(file="../../Results/Plots/Phylogenies/Case_studies/Case3.pdf", width=8, height=5, family="Times", pointsize=14)
Reps <- c(PhyloMammal_UN$tip.label[grepl("Hylopetes lepidus|Petinomys sagitta",
PhyloMammal_UN$tip.label)], "Hylopetes sagitta")
Reps <- paste(paste(substr(Reps, 1,2), ".", sep=""), word(Reps, 2), sep=" ")
par(mar=c(0,0,1,0), oma=c(0,1,1,1), family="sans")
par(mfrow=c(1,3))
# For the uncorrected tree
Hylopetes <- drop.tip(PhyloMammal_UN, PhyloMammal_UN$tip.label[!grepl("Hylopetes|Petinomys", PhyloMammal_UN$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% Reps, "red","black"), cex=1, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% Reps, 4,3), main="A. Uncorrected",  node.depth=2)
# For the corrected tree
Hylopetes <- drop.tip(Phylo_Mammals, Phylo_Mammals$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,ifelse(Hylopetes$tip.label %in% "Hy. sagitta", 4, 3)), main="B. Corrected", node.depth=2)
# For the corrected tree after removing replicated tips
Hylopetes <- drop.tip(Phylo_Mammals.final, Phylo_Mammals.final$tip.label[!grepl("Hylopetes|Petinomys", Phylo_Mammals.final$tip.label)])
Hylopetes$tip.label <- paste(paste(substr(Hylopetes$tip.label, 1,2), ".", sep=""), word(Hylopetes$tip.label, 2), sep=" ")
plot(Hylopetes,tip.color=ifelse(Hylopetes$tip.label %in% "Hy. sagitta", "blue","black"), cex=1, adj=0, label.offset=1,
font=ifelse(Hylopetes$tip.label %in% "Pe. sagitta", 4,ifelse(Hylopetes$tip.label %in% "Hy. sagitta", 4, 3)), main="C. After removing replicated tips", node.depth=2)
box("outer")
dev.off()
# No taxonomic correction
UN_Amphibians <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Amphibians.csv")
# With taxonomic correction
C_Amphibians <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Amphibians.csv")
UN_Mammals <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Mammals.csv")
C_Mammals <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Mammals.csv")
UN_Birds <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Birds.csv")
C_Birds <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Birds.csv")
UN_Reptiles <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Reptiles.csv")
C_Reptiles <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Reptiles.csv")
7/11
1/3
2/3
8/10
