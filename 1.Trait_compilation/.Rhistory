screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Amphibians)
p2 <- Plot_NA_patterns(PhyloAmphibians, Results, Amphibians, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 400, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 500, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-650)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Amphibians, X[i])
p <- Plot_NA_patterns(PhyloAmphibians, Results, Amphibians, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=100, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Amphibians)
p2 <- Plot_NA_patterns(PhyloAmphibians, Results, Amphibians, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 400, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 500, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-650)
dev.off()
X <- c("Body_mass_g", "Range_size_m2", "Litter_size","Habitat_breadth_IUCN","Specialisation",'Diel_activity',
"Longevity_d", "Trophic_level", "Adult_svl_cm", "Maturity_d")
Titles <- c("BM", "RS", "LCS", "HB", "Sp", "DA", "L", "TL", "BL", "M")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=100, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
X <- c("Body_mass_g", "Range_size_m2", "Litter_size","Habitat_breadth_IUCN","Specialisation",'Diel_activity',
"Longevity_d", "Trophic_level", "Adult_svl_cm", "Maturity_d")
Titles <- c("BM", "RS", "LCS", "HB", "Sp", "DA", "L", "TL", "BL", "M")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 400, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 400, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 500, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
add.color.bar(prompt=TRUE, 100, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
add.color.bar(prompt=TRUE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
add.color.bar(prompt=TRUE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
X <- c("Body_mass_g", "Range_size_m2", "Litter_size","Habitat_breadth_IUCN","Specialisation",'Diel_activity',
"Longevity_d", "Trophic_level", "Adult_svl_cm", "Maturity_d")
Titles <- c("BM", "RS", "LCS", "HB", "Sp", "DA", "L", "TL", "BL", "M")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-650)
mtext("A", side=3, font=2, cex=1.5, at=-350)
mtext("A", side=3, font=2, cex=1.5, at=-400)
X <- c("Body_mass_g", "Range_size_m2", "Litter_size","Habitat_breadth_IUCN","Specialisation",'Diel_activity',
"Longevity_d", "Trophic_level", "Adult_svl_cm", "Maturity_d")
Titles <- c("BM", "RS", "LCS", "HB", "Sp", "DA", "L", "TL", "BL", "M")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
X <- c("Body_mass_g", "Range_size_m2", "Litter_size","Habitat_breadth_IUCN","Specialisation",'Diel_activity',
"Longevity_d", "Trophic_level", "Adult_svl_cm", "Maturity_d")
Titles <- c("BM", "RS", "LCS", "HB", "Sp", "DA", "L", "TL", "BL", "M")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=TRUE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=TRUE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=20, y=5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=20, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=0, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-100, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-1000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-10000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-5000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-4000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-3000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-1000, y=5, subtitle="within family coverage (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-1000, y=0, subtitle="within family coverage (%)")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-1000, y=0, subtitle="within family msiing values (%)")
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-1000, y=0, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-100, y=0, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-200, y=0, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=0, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-1, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-10, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=200, y=-5, subtitle="% representation")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
# Reptiles
dev.off()
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family msiing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
pdf(file="../../Results/Plots/Phylogeny_missing_values/Reptiles_coverage.pdf", width=10, height=15, pointsize=9)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family missing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
dev.off
dev.off()
dev.off()
pdf(file="../../Results/Plots/Phylogeny_missing_values/Reptiles_coverage.pdf", width=10, height=15, pointsize=9)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family missing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
dev.off()
pdf(file="../../Results/Plots/Phylogeny_missing_values/Reptiles_coverage.pdf", width=10, height=10, pointsize=9)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family missing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
dev.off()
pdf(file="../../Results/Plots/Phylogeny_missing_values/Reptiles_coverage.pdf", width=8, height=8, pointsize=9)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family missing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
dev.off()
pdf(file="../../Results/Plots/Phylogeny_missing_values/Reptiles_coverage.pdf", width=7, height=8, pointsize=9)
split.screen(c(1,2))
screen(1)
split.screen(c(3,4))
screen(3)
par(oma=c(4,0,2,4), las=1)
for (i in 1:11) {
screen(i+2)
Results <- PercentNA_families(Reptiles, X[i])
p <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, FALSE, FALSE)
mtext(text = Titles[i], line =-12, at=80, font = 2)
}
screen(2)
par(oma=c(4,2,1.5,0), las=1)
Results <- Family_rep(Reptiles)
p2 <- Plot_NA_patterns(PhyloReptiles, Results, Reptiles, TRUE, FALSE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 300, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-500, y=-5, subtitle="within family missing values (%)")
add.color.bar(prompt=FALSE, 300, cols=p2$cols, title="",  digits=0, lims = range(Results$Percent), x=150, y=-5, subtitle="% representation")
close.screen()
box("outer")
mtext("B", side=3, font=2, cex=1.5)
mtext("A", side=3, font=2, cex=1.5, at=-400)
dev.off()
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/2.Imputations/6.missForest_imputations_corrected_trees.R', echo=TRUE)
## Patterns in missing trait values with regards to the phylogenetic position of the species
# plot per traits (percent and number of species with missing values within families for each trait)
# plot completeness (within family median)
library(phytools)
library(dplyr)
library(ape)
library(picante)
`%nin%` <- Negate(`%in%`)
source("Functions_patterns_missing_values.R")
## Traits
Traits <- c("Body_mass_g",
"Longevity_d",
"Litter_size",
"Range_size_m2",
"Habitat_breadth_IUCN",
"Specialisation",
"Trophic_level",
"Diel_activity",
"Primary_diet",
"Diet_breadth")
TraitsReptiles <- c(Traits[1:8], "Adult_svl_cm", "Maturity_d")
TraitsAmphibians <- c(Traits, "Body_length_mm")
TraitsMammals <- c(Traits, "Adult_svl_cm", "Generation_length_d")
TraitsBirds <- c(Traits, "Generation_length_d")
## Load phylogenies
PhyloAmphibians <- read.newick("../../Results/1.Phylogenies/Corrected/2.Dropped_tips/Amphibians.nwk") %>% .Format_tiplabels()
PhyloMammals <- read.newick("../../Results/1.Phylogenies/Corrected/2.Dropped_tips/Mammals.nwk")  %>% .Format_tiplabels()
PhyloBirds <- read.newick("../../Results/1.Phylogenies/Corrected/2.Dropped_tips/Birds.nwk")  %>% .Format_tiplabels()
PhyloReptiles <- read.newick("../../Results/1.Phylogenies/Corrected/2.Dropped_tips/Reptiles.nwk")  %>% .Format_tiplabels()
## Load traits
Amphibians <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Amphibians.csv")
Birds <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Birds.csv")
Mammals <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Mammals.csv")
Reptiles <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Reptiles.csv")
Traits_cont <-  c("Body_mass_g", "Longevity_d", "Litter_size", "Diet_breadth",
"Range_size_m2", "Habitat_breadth_IUCN")
Traits_cat <- c("Specialisation", "Diel_activity","Trophic_level", "Primary_diet")
## All together without the tip labels
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Amphibians_completeness_results <- Completeness_families(Amphibians, TraitsAmphibians)
Reptiles_completeness_results <- Completeness_families(Reptiles, TraitsReptiles)
Birds_completeness_results <- Completeness_families(Birds, TraitsBirds)
Mammals_completeness_results <- Completeness_families(Mammals, TraitsMammals)
## All together without the tip labels
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE)
par(xpd=NA)
add.color.bar(prompt=FALSE, 50, cols=p$cols, title="",  digits=2, lims = c(0,100), x=1, y=1, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 50, cols=p$cols, title="",  digits=2, lims = c(0,100), x=0, y=-1, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 50, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-10, y=-10, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 50, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-10, y=-30, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 100, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-10, y=-30, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-10, y=-30, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-30, y=-30, subtitle="within family completeness")
## All together without the tip labels
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A")
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=1)
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5)
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.1)
par
## All together without the tip labels
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,1,2,1), oma=c(1,1,2,1))
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.1)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(1,1,2,1))
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.1)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE)
par(xpd=NA)
## All together without the tip labels
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(5,1,2,1))
par(xpd=NA)
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.1)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, at=-5)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, at=-15)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(5,1,2,1))
par(xpd=NA)
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, at=-15)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE); title("C", line=0.5)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE); title("D", line=0.5)
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5, adj=0)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(5,1,2,1))
par(xpd=NA)
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE); title("C", line=0.5, adj=0, font=2)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE); title("D", line=0.5, agj=0, font=2)
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-30, y=-30, subtitle="within family completeness")
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-40, y=-30, subtitle="within family completeness")
## All together without the tip labels
pdf(file="../../Results/Plots/Phylogeny_missing_values/Completeness_all.pdf", width=7, height=5, pointsize=9)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(5,1,2,1))
par(xpd=NA)
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE); title("C", line=0.5, adj=0, font=2)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE); title("D", line=0.5, adj=0, font=2)
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-40, y=-30, subtitle="within family completeness")
box("outer")
dev.off()
## All together without the tip labels
pdf(file="../../Results/Plots/Phylogeny_missing_values/Completeness_all.pdf", width=7, height=5, pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(5,1,5,1), oma=c(5,1,2,1))
par(xpd=NA)
par(mfrow=c(2,2))
Plot_NA_patterns(PhyloMammals, Mammals_completeness_results, Mammals, FALSE, TRUE); title("A", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloBirds, Birds_completeness_results, Birds, FALSE, TRUE); title("B", line=0.5, adj=0, font=2)
Plot_NA_patterns(PhyloReptiles, Reptiles_completeness_results, Reptiles, FALSE, TRUE); title("C", line=0.5, adj=0, font=2)
p <- Plot_NA_patterns(PhyloAmphibians, Amphibians_completeness_results, Amphibians, FALSE, TRUE); title("D", line=0.5, adj=0, font=2)
add.color.bar(prompt=FALSE, 150, cols=p$cols, title="",  digits=2, lims = c(0,100), x=-40, y=-20, subtitle="within family completeness")
box("outer")
dev.off()
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/1.Trait_compilation/6.Compare_with_without_taxonomic_corrections.R', echo=TRUE)
# # #   P  R  E  A  M  B  L  E
setwd("../../../1.Trait_compilation/Code/1.Trait_compilation")
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/1.Trait_compilation/6.Compare_with_without_taxonomic_corrections.R', echo=TRUE)
X <- c("Rphylopars", "dplyr", "phytools", "picante", "stringr", "PVR", "missForest", "colorspace", "ggtree", "ape", "treeio", "ngram","phylobase")
lapply(X, library, character.only=TRUE); rm(X)
source("Functions_for_phylogenies.R")
?PVRdecomp
library(missForest)
?missForest
