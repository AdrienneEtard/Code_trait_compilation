Plot.Delta.Cov(UN_Mammals, C_Mammals, TMammalsI, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TBirdsI, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TReptilesI, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TAmphibiansI, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-10, "% coverage", cex=0.8)
mtext(at=-110, line=-10, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-10, "% coverage", cex=0.8)
mtext(at=-110, line=-10, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-10, "% coverage", cex=0.8)
mtext(at=-110, line=-10, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-15, "% coverage", cex=0.8)
mtext(at=-110, line=-15, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-10, "% coverage", cex=0.8)
mtext(at=-110, line=-10, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=40, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=40, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=20, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=40, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
#mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-110, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
#mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-120, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
#mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-120, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
#mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
pdf(file="../../Results/Plots/Coverage/Predictor_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TMammalsI, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TBirdsI, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TReptilesI, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TAmphibiansI, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Predictor_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TMammalsI, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TBirdsI, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TReptilesI, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TAmphibiansI, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/1.Trait_compilation/1.Compile_trait_data.R', echo=TRUE)
View(TraitsMammal)
log10(34839.98250)
log10(17)
X <- c("dplyr", "stringr")
lapply(X, library, character.only=TRUE); rm(X)
`%nin%` = Negate(`%in%`)
Mammals <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/1.compiled/Mammals.csv")
Birds <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/1.compiled/Birds.csv")
Amphibians <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/1.compiled/Amphibians.csv")
Reptiles <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/1.compiled/Reptiles.csv")
U_Mammals <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/1.compiled/Mammals.csv")
U_Birds <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/1.compiled/Birds.csv")
U_Amphibians <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/1.compiled/Amphibians.csv")
U_Reptiles <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/1.compiled/Reptiles.csv")
Syn_Mammals <- read.csv("../../Results/0.Data_resolved_taxonomy/List_species_synonyms/Synonym_final_datasets/Mammals.csv")
Syn_Amphibians <- read.csv("../../Results/0.Data_resolved_taxonomy/List_species_synonyms/Synonym_final_datasets/Amphibians.csv")
Syn_Birds <- read.csv("../../Results/0.Data_resolved_taxonomy/List_species_synonyms/Synonym_final_datasets/Birds.csv")
Syn_Reptiles <- read.csv("../../Results/0.Data_resolved_taxonomy/List_species_synonyms/Synonym_final_datasets/Reptiles.csv")
## Predicts
Predicts <- readRDS("../../Results/0.Data_resolved_taxonomy/Processed_datasets/PredictsVertebrates.rds")
Range.Mammals <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Mammal_range.csv")
Range.Reptiles <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Reptile_range.csv")
Range.Birds <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Bird_range.csv")
Range.Amphibians <- read.csv("../../Results/0.Data_resolved_taxonomy/Processed_datasets/Traits/Amphibian_range.csv")
# Filter out of the trait compilation all species for which all information is NA (such as amphibian species "Eleutherodactylus fitzingereri")
FilterOut <- function(TraitDF) {
TraitDF$Best_guess_binomial <- as.character(TraitDF$Best_guess_binomial)
ToRemove <- c()
for (i in 1:nrow(TraitDF)) {
X <- all(is.na(TraitDF[i, c(2:ncol(TraitDF))]))
if(X==TRUE) {ToRemove <- c(ToRemove, TraitDF$Best_guess_binomial[i])}
}
return(ToRemove)
}
Species_Intersect <- function(TraitDF, Predicts, Range, Class) {
Species_to_check <- FilterOut(TraitDF)
print(length(Species_to_check))
PSp <- unique(Predicts$Best_guess_binomial[Predicts$Class==Class])
Y <- intersect(Species_to_check, PSp)
print(paste(length(Y), "species intersect with PREDICTS species."))
PRa <- unique(Range$Best_guess_binomial) %>% as.character()
Z <- intersect(Species_to_check, PRa)
print(paste(length(Z), "species intersect with Range dataset species."))
Intersecting <- c(Y,Z) %>% unique()
SpeciesToRemove <- setdiff(Species_to_check, Intersecting)
return(SpeciesToRemove)
}
# Add family and order to the data
Add_family_order_genus <- function(TraitDF, SynDF) {
# browser()
TraitDF$Best_guess_binomial <- as.character(TraitDF$Best_guess_binomial)
SynDF$Genus <- as.character(SynDF$Genus)
SynDF$Family <- as.character(SynDF$Family)
SynDF$Order <- as.character(SynDF$Order)
TraitDF$Genus <- NA
TraitDF$Family <- NA
TraitDF$Order <- NA
Sp <- intersect(TraitDF$Best_guess_binomial, SynDF$Accepted)
for (i in 1:length(Sp)) {
TraitDF$Genus[TraitDF$Best_guess_binomial==Sp[i]] <- SynDF$Genus[SynDF$Accepted==Sp[i]] %>% as.character %>% unique()
TraitDF$Family[TraitDF$Best_guess_binomial==Sp[i]] <- SynDF$Family[SynDF$Accepted==Sp[i]] %>% as.character %>% unique()
TraitDF$Order[TraitDF$Best_guess_binomial==Sp[i]] <- SynDF$Order[SynDF$Accepted==Sp[i]] %>% as.character %>% unique()
}
Sp2 <- setdiff(TraitDF$Best_guess_binomial, Sp)
if (length(Sp2!=0)) {
if (Sp2=="Desmodus draculae") {
TraitDF$Genus[TraitDF$Best_guess_binomial=="Desmodus draculae"] <- "Desmodus"
TraitDF$Family[TraitDF$Best_guess_binomial=="Desmodus draculae"] <- "PHYLLOSTOMIDAE"
TraitDF$Order[TraitDF$Best_guess_binomial=="Desmodus draculae"] <- "CHIROPTERA"
}
else {
for (i in 1:length(Sp2)) {
TraitDF$Genus[TraitDF$Best_guess_binomial==Sp2[i]] <- SynDF$Genus[SynDF$CorrectedTypos==Sp2[i]] %>% as.character %>% unique()
TraitDF$Family[TraitDF$Best_guess_binomial==Sp2[i]] <- SynDF$Family[SynDF$CorrectedTypos==Sp2[i]] %>% as.character %>% unique()
TraitDF$Order[TraitDF$Best_guess_binomial==Sp2[i]] <- SynDF$Order[SynDF$CorrectedTypos==Sp2[i]] %>% as.character %>% unique()
}
}
}
return(TraitDF)
}
# Corrected
ToRemoveBirds <- Species_Intersect(Birds, Predicts, Range.Birds, "Aves")
ToRemoveMammals <- Species_Intersect(Mammals, Predicts, Range.Mammals, "Mammalia")
ToRemoveAmphibians <- Species_Intersect(Amphibians, Predicts, Range.Amphibians, "Amphibia")
ToRemoveReptiles <- Species_Intersect(Reptiles, Predicts, Range.Reptiles, "Reptilia")
Mammals <- Mammals %>% filter(Best_guess_binomial %nin% ToRemoveMammals)
Reptiles <- Reptiles %>% filter(Best_guess_binomial %nin% ToRemoveReptiles)
Amphibians <- Amphibians %>% filter(Best_guess_binomial %nin% ToRemoveAmphibians)
U_ToRemoveBirds <- Species_Intersect(U_Birds, Predicts, Range.Birds, "Aves")
U_ToRemoveMammals <- Species_Intersect(U_Mammals, Predicts, Range.Mammals, "Mammalia")
U_ToRemoveAmphibians <- Species_Intersect(U_Amphibians, Predicts, Range.Amphibians, "Amphibia")
U_ToRemoveReptiles <- Species_Intersect(U_Reptiles, Predicts, Range.Reptiles, "Reptilia")
U_Mammals <- U_Mammals %>% filter(Best_guess_binomial %nin% U_ToRemoveMammals)
U_Reptiles <- U_Reptiles %>% filter(Best_guess_binomial %nin% U_ToRemoveReptiles)
U_Amphibians <- U_Amphibians %>% filter(Best_guess_binomial %nin% U_ToRemoveAmphibians)
Mammals <- Add_family_order_genus(Mammals, Syn_Mammals)
Amphibians <- Add_family_order_genus(Amphibians, Syn_Amphibians)
Reptiles <- Add_family_order_genus(Reptiles, Syn_Reptiles)
Birds <- Add_family_order_genus(Birds, Syn_Birds)
write.csv(Mammals, "../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/2.filtered_taxinfo/All/Mammals.csv", row.names = FALSE)
write.csv(Amphibians, "../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/2.filtered_taxinfo/All/Amphibians.csv", row.names = FALSE)
write.csv(Reptiles, "../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/2.filtered_taxinfo/All/Reptiles.csv", row.names = FALSE)
write.csv(Birds, "../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/2.filtered_taxinfo/All/Birds.csv", row.names=FALSE)
write.csv(U_Mammals, "../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/2.filtered/Mammals.csv", row.names = FALSE)
write.csv(U_Amphibians, "../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/2.filtered/Amphibians.csv", row.names = FALSE)
write.csv(U_Reptiles, "../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/2.filtered/Reptiles.csv", row.names = FALSE)
write.csv(U_Birds, "../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/2.filtered/Birds.csv", row.names=FALSE)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/1.Trait_compilation/3.Clean_Standardise.R', echo=TRUE)
View(Mammals)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/1.Trait_compilation/3.Clean_Standardise_NO_TAXONOMIC_CORRECTION.R', echo=TRUE)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/1.Trait_compilation/5.Add_phylogenetic_eigenvectors.R', echo=TRUE)
X <- c("dplyr", "ggplot2", "ggpubr", "grid", "cowplot")
lapply(X, library, character.only=TRUE); rm(X)
source("Comparison_with_without_taxonomic_corrections_functions.R")
## Load trait files
# No taxonomic correction
UN_Amphibians <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Amphibians.csv")
UN_Birds <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Birds.csv")
UN_Mammals <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Mammals.csv")
UN_Reptiles <- read.csv("../../Results/1.Traits_before_imputations/Without_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Reptiles.csv")
# With taxonomic correction
C_Amphibians <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Amphibians.csv")
C_Birds <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Birds.csv")
C_Mammals <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Mammals.csv")
C_Reptiles <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/4.with_phylo_eigenvectors/Reptiles.csv")
## Load PREDICTS
UN_Predicts <- readRDS("../../Data/PREDICTS_database.rds") %>%
filter(Class %in% c("Aves", "Mammalia", "Reptilia", "Amphibia"))
C_Predicts <- readRDS("../../Results/0.Data_resolved_taxonomy/Processed_datasets/PredictsVertebrates.rds")
## 1. Differences in species number
# Amphibians
Delta_Number(UN_Amphibians, C_Amphibians, "Amphibia", "all species", C_Predicts, UN_Predicts)
Delta_Number(UN_Amphibians, C_Amphibians, "Amphibia", "Predicts", C_Predicts, UN_Predicts)
# Mammals
Delta_Number(UN_Mammals, C_Mammals, "Mammalia", "all species", C_Predicts, UN_Predicts)
Delta_Number(UN_Mammals, C_Mammals, "Mammalia", "Predicts", C_Predicts, UN_Predicts)
# Birds
Delta_Number(UN_Birds, C_Birds, "Aves", "all species", C_Predicts, UN_Predicts)
Delta_Number(UN_Birds, C_Birds, "Aves", "Predicts", C_Predicts, UN_Predicts)
# Reptiles
Delta_Number(UN_Reptiles, C_Reptiles, "Reptilia", "all species", C_Predicts, UN_Predicts)
Delta_Number(UN_Reptiles, C_Reptiles, "Reptilia", "Predicts", C_Predicts, UN_Predicts)
# 2.1. % Species representation in phylogenies
CovPhyloAll <- Phylo_Delta(C_Mammals, C_Birds, C_Reptiles, C_Amphibians, C_Predicts, FALSE,
UN_Mammals, UN_Birds, UN_Reptiles, UN_Amphibians, UN_Predicts)
CovPhyloPredicts <- Phylo_Delta(C_Mammals, C_Birds, C_Reptiles, C_Amphibians, C_Predicts, TRUE,
UN_Mammals, UN_Birds, UN_Reptiles, UN_Amphibians, UN_Predicts)
CovPhyloAll
CovPhyloPredicts
p <- PlotPhyloCov(CovPhyloAll,CovPhyloPredicts, 15)
ggsave(p, file="../../Results/Plots/Coverage/Phylogenies/Species_representation.pdf", width=8, height=4.2)
p
TraitsBirds <-  c("log10_Body_mass_g", "log10_Adult_svl_cm", "log10_Maturity_d", "log10_Longevity_d",
"log10_Litter_size", "Range_size_m2", "Diel_activity", "Primary_diet","Trophic_level","Specialisation",
"sqrt_Habitat_breadth_IUCN")
TraitsMammals <-  c("log10_Body_mass_g", "log10_Adult_svl_cm", "log10_Forearm_length_mm","log10_Head_length_mm",
"log10_Generation_length_d", "log10_Maturity_d", "log10_Longevity_d", "log10_AFR_d",
"log10_Litter_size", "Range_size_m2", "Diel_activity", "Primary_diet","Trophic_level","Specialisation",
"sqrt_Habitat_breadth_IUCN")
TraitsAmphibians <-  c("log10_Body_mass_g", "log10_Body_length_mm","log10_Svl_length_mm", "log10_Maturity_d", "log10_Longevity_d",
"log10_Litter_size", "Range_size_m2", "Diel_activity","Primary_diet", "Trophic_level","Specialisation",
"sqrt_Habitat_breadth_IUCN")
TraitsReptiles <-  c("log10_Body_mass_g", "log10_Adult_svl_cm", "log10_Maturity_d", "log10_Longevity_d",
"log10_Litter_size", "Range_size_m2", "Diel_activity", "Primary_diet","Trophic_level", "Specialisation",
"sqrt_Habitat_breadth_IUCN")
TargetTraits <- c("log10_Body_mass_g",
"log10_Longevity_d",
"log10_Litter_size",
"Range_size_m2",
"Diel_activity",
"Trophic_level",
"sqrt_Diet_breadth",
"Specialisation",
"sqrt_Habitat_breadth_IUCN",
"Primary_diet")
# For all species
pdf(file="../../Results/Plots/Coverage/Target_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Target_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TargetTraits, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TargetTraits, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TargetTraits, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TargetTraits, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
## Delta in trait coverage before and after taxonomic correction -- FOR TRAITS USED IN MISSFOREST IMPUTATIONS only
Traits_cont <-  c("log10_Body_mass_g", "log10_Longevity_d", "log10_Litter_size", "Range_size_m2", "sqrt_Habitat_breadth_IUCN", "sqrt_Diet_breadth")
Traits_cat <- c("Specialisation", "Diel_activity","Trophic_level")
TMammalsI <- c(Traits_cont, Traits_cat, "log10_Generation_length_d", "log10_Adult_svl_cm")
TBirdsI <- c(Traits_cont, Traits_cat)
TReptilesI <- c(Traits_cont, Traits_cat, "log10_Adult_svl_cm", "log10_Maturity_d")
TAmphibiansI <- c(Traits_cont, Traits_cat, "log10_Body_length_mm")
# For all species
pdf(file="../../Results/Plots/Coverage/Predictor_traits/All_species.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TMammalsI, FALSE, UN_Predicts, C_Predicts, "A. Mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TBirdsI, FALSE, UN_Predicts, C_Predicts, "B. Birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TReptilesI, FALSE, UN_Predicts, C_Predicts, "C. Reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TAmphibiansI, FALSE, UN_Predicts, C_Predicts, "D. Amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
# For PREDICTS species
pdf(file="../../Results/Plots/Coverage/Predictor_traits/Predicts.pdf", width=7, height=5.5, family="Times", pointsize=12)
par(family='serif', tcl=0.2, cex.lab=1, mgp=c(1.5,0.2,0), mar = c(3,7,2,2), oma=c(5,2,1,1))
par(mfrow=c(2,2))
Plot.Delta.Cov(UN_Mammals, C_Mammals, TMammalsI, TRUE, UN_Predicts, C_Predicts, "A. PREDICTS mammals")
Plot.Delta.Cov(UN_Birds, C_Birds, TBirdsI, TRUE, UN_Predicts, C_Predicts, "B. PREDICTS birds")
Plot.Delta.Cov(UN_Reptiles, C_Reptiles, TReptilesI, TRUE, UN_Predicts, C_Predicts, "C. PREDICTS reptiles")
Plot.Delta.Cov(UN_Amphibians, C_Amphibians, TAmphibiansI, TRUE, UN_Predicts, C_Predicts, "D. PREDICTS amphibians")
box("outer")
mtext(at=50, line=-11, "% coverage", cex=0.8)
mtext(at=-130, line=-11, "% coverage", cex=0.8)
legend(x=-110, y=-6, xpd="NA", title="Trait coverage across all species",
legend = c("Without taxonomic correction", "With taxonomic correction"),
fill = c("lightgrey", "deepskyblue3"),  box.lty=0)
dev.off()
