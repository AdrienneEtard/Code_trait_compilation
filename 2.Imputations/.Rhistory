ToPlot$class <- factor(ToPlot$class, levels=c("Aves", "Mammalia"))
if(length(unique(ToPlot$outcome))==3){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(AxisX) + ylab("% species") +
scale_x_discrete(limits=c("different","unknown", "same"), labels=c("Contradicting","Unknown", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size = 8,margin = margin(t = 0), hjust=0.9)) +
theme(legend.position="none")
}
if(length(unique(ToPlot$outcome))==2){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(AxisX) + ylab("% species") +
scale_x_discrete(limits=c("different", "same"), labels=c("Contradicting", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size = 8, margin = margin(t = 0), hjust=0.9)) +
theme(legend.position="none")
}
if(Diet) {return(list(p=p, outputs=xreturn))}
else{return(p)}
}}
p1 <- Plot_all_values(RC_Imputed, AE_Imputed, "log10_Body_mass_kg", FALSE, AxisX = "Body mass (kg, log10, AE)", AxisY = "Body mass (kg, log10, RC)", Diet = FALSE) +
labs(tag = "A") + theme(plot.tag.position = c(0.3, 0.92))
p2 <- Plot_all_values(RC_Imputed, AE_Imputed, "Litter_size", FALSE, AxisX = "Litter size (AE)", AxisY = "Litter size (RC)", Diet = FALSE)+
labs(tag = "B") + theme(plot.tag.position = c(0.3, 0.92))
p3 <- Plot_all_values(RC_Imputed, AE_Imputed, "Habitat_breadth_IUCN", FALSE, AxisX = "Habitat breadth (AE)", AxisY = "Habitat breadth (RC)", Diet = FALSE)+
labs(tag = "C") + theme(plot.tag.position = c(0.3, 0.92))
p4 <- Plot_all_values(RC_Imputed, AE_Imputed, "Diel_activity", TRUE, AxisX = "Diel activity", AxisY = "Diel activity", Diet = FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.3, 0.81))
p5 <- Plot_all_values(RC_Imputed, AE_Imputed, "Primary_diet", TRUE, AxisX = "Primary diet", AxisY = "Pirmary diet", Diet = TRUE)
p5p <- p5$p + labs(tag = "E") + theme(plot.tag.position = c(0.3, 0.81))
p <- ggarrange(p1,p2,p3,p4,p5p,common.legend = TRUE)
ggsave(p, file="../../Results/Plots/Comparison_with_RCooke/Comparison_all_values.pdf", width =8, height =5)
Plot_all_values <- function(RC_data, AE_data, TraitName, Categorical, Diet, AxisX, AxisY) {
X <- intersect(RC_data$binomial, AE_data$Best_guess_binomial)
RC_data <- RC_data %>% filter(binomial %in% X)
AE_data <- AE_data %>% filter(Best_guess_binomial %in% X)
GGPoptions <- theme_classic() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=12),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=12),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
ToPlot <- RC_data[, c("class","binomial", TraitName)]
colnames(ToPlot)[3] <- "RC"
ToPlot$AE <- AE_data[, TraitName]
if(!Categorical) {
p <- ggplot(ToPlot, aes(AE, RC, color=ToPlot$class)) +
GGPoptions +
geom_point(alpha=0.7) +
geom_abline(slope = 1, intercept = 0, alpha=0.5) +
xlab(AxisX) +
ylab(AxisY) +
scale_color_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f"))
return(p)}
else {
Outcome <- AE_data[, c("Class","Best_guess_binomial")]
if(Diet) {
x1 <- AE_data[,c("Best_guess_binomial",TraitName)]; colnames(x1)[2] <- "Primary_diet_AE"
x2 <- RC_data[, c("binomial",TraitName)]; colnames(x2)[2] <- "Primary_diet_RC"
xreturn <- cbind(x1,x2)
xreturn <- xreturn %>%
filter(Primary_diet_AE!=Primary_diet_RC)
}
for (i in 1:nrow(AE_data)){
x <- AE_data[i, TraitName]
y <- RC_data[i, TraitName]
if(x==y) {Outcome$Result[i] <- "same"}
if(x!=y)  { Outcome$Result[i] <- "different"}
}
ToPlot <-  with(Outcome, table(Result, Class)) %>%
as.data.frame() %>%
group_by(Class) %>%
mutate(Freq=Freq/sum(Freq)*100) %>%
setNames(., c("outcome", "class", "prop")) %>%
as.data.frame()
ToPlot <- ToPlot[order(ToPlot$prop),]
ToPlot$class <- factor(ToPlot$class, levels=c("Aves", "Mammalia"))
if(length(unique(ToPlot$outcome))==3){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(AxisX) + ylab("% species") +
scale_x_discrete(limits=c("different","unknown", "same"), labels=c("Contradicting","Unknown", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size =7,margin = margin(t = 0), hjust=1)) +
theme(legend.position="none")
}
if(length(unique(ToPlot$outcome))==2){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(AxisX) + ylab("% species") +
scale_x_discrete(limits=c("different", "same"), labels=c("Contradicting", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size =7, margin = margin(t = 0), hjust=1)) +
theme(legend.position="none")
}
if(Diet) {return(list(p=p, outputs=xreturn))}
else{return(p)}
}}
## Plot all traits against each other
p1 <- Plot_all_values(RC_Imputed, AE_Imputed, "log10_Body_mass_kg", FALSE, AxisX = "Body mass (kg, log10, AE)", AxisY = "Body mass (kg, log10, RC)", Diet = FALSE) +
labs(tag = "A") + theme(plot.tag.position = c(0.3, 0.92))
p2 <- Plot_all_values(RC_Imputed, AE_Imputed, "Litter_size", FALSE, AxisX = "Litter size (AE)", AxisY = "Litter size (RC)", Diet = FALSE)+
labs(tag = "B") + theme(plot.tag.position = c(0.3, 0.92))
p3 <- Plot_all_values(RC_Imputed, AE_Imputed, "Habitat_breadth_IUCN", FALSE, AxisX = "Habitat breadth (AE)", AxisY = "Habitat breadth (RC)", Diet = FALSE)+
labs(tag = "C") + theme(plot.tag.position = c(0.3, 0.92))
p4 <- Plot_all_values(RC_Imputed, AE_Imputed, "Diel_activity", TRUE, AxisX = "Diel activity", AxisY = "Diel activity", Diet = FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.3, 0.81))
p5 <- Plot_all_values(RC_Imputed, AE_Imputed, "Primary_diet", TRUE, AxisX = "Primary diet", AxisY = "Pirmary diet", Diet = TRUE)
p5p <- p5$p + labs(tag = "E") + theme(plot.tag.position = c(0.3, 0.81))
p <- ggarrange(p1,p2,p3,p4,p5p,common.legend = TRUE)
ggsave(p, file="../../Results/Plots/Comparison_with_RCooke/Comparison_all_values.pdf", width =8, height =5)
Compare <- function(RC_data, RC_imputed, AE_data, AE_imputed, Imputed,
TraitName, Categorical,
Traitaxis, ImputedaxisX, ImputedaxisY,
Comparison, CompRC_collected, Diet) {
if(Imputed) {
# Filter species for which the trait value was imputed
# AE data
Sp_AE_I <- AE_data$Best_guess_binomial[is.na(AE_data[,TraitName])]
# if the coverage for that trait was 100% initially, compared my collected values to Rob's imputed values (if they exist)
if (length(Sp_AE_I)!=0) {
AE_imputed <- AE_imputed %>%
filter(Best_guess_binomial %in% Sp_AE_I)
AE_data <- AE_imputed
}
else{ImputedaxisX <- "collected"}
# RC data
Sp_RC_I <- RC_data$binomial[is.na(RC_data[,TraitName])]
# if the coverage for that trait was 100% initially, compared my imputed values to Rob's collected values
if (length(Sp_RC_I)!=0) {
RC_imputed <- RC_imputed %>%
filter(binomial %in% Sp_RC_I)
RC_data <- RC_imputed
}
else{ImputedaxisY <- "collected"}
}
if(Comparison) {
# RC collected VS AE imputed
if(CompRC_collected){
Sp_RC_C <- RC_data$binomial[!is.na(RC_data[,TraitName])]
Sp_AE_I <- AE_data$Best_guess_binomial[is.na(AE_data[,TraitName])]
Sp <- intersect(Sp_RC_C, Sp_AE_I)
if(length(Sp)==0) {print("The data does not allow this comparison.")
stop()}
else{
RC_data <- RC_data %>% filter(binomial %in% Sp)
RC_data <- RC_data[, c("class","binomial",TraitName)]
AE_data <- AE_imputed %>% filter(Best_guess_binomial %in% Sp)
AE_data <- AE_data[, c("Class","Best_guess_binomial",TraitName)]
ImputedaxisX <- "imputed"
ImputedaxisY <- "collected"
}
}
# RC imputed VS AE collected
if(!CompRC_collected){
Sp_RC_I <- RC_data$binomial[is.na(RC_data[,TraitName])]
Sp_AE_C <- AE_data$Best_guess_binomial[!is.na(AE_data[,TraitName])]
Sp <- intersect(Sp_RC_I, Sp_AE_C)
if(length(Sp)==0) {print("The data does not allow this comparison.")
stop()}
else{
RC_data <- RC_imputed %>% filter(binomial %in% Sp)
RC_data <- RC_data[, c("class","binomial",TraitName)]
AE_data <- AE_data %>% filter(Best_guess_binomial %in% Sp)
AE_data <- AE_data[, c("Class","Best_guess_binomial",TraitName)]
ImputedaxisX <- "collected"
ImputedaxisY <- "imputed"
}
}
}
# intersect AE and RC species
Y <- intersect(RC_data$binomial, AE_data$Best_guess_binomial)
RC_data <- RC_data %>% filter(binomial %in% Y)
AE_data <- AE_data %>% filter(Best_guess_binomial %in% Y)
# plot
GGPoptions <- theme_classic() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=12),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=12),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
if(!Categorical) {
ToPlot <- RC_data[, c("class","binomial", TraitName)]
colnames(ToPlot)[3] <- "RC"
ToPlot$AE <- AE_data[, TraitName]
# Ssize <- paste("N=",length(unique(ToPlot$binomial)), sep="")
# Xp <- max(ToPlot$AE, na.rm=TRUE)*(3/4)
# Yp <- max(ToPlot$RC, na.rm=TRUE)*(1/10)
p <- ggplot(ToPlot, aes(AE, RC, color=ToPlot$class)) +
GGPoptions +
geom_point(alpha=0.7) +
geom_abline(slope = 1, intercept = 0, alpha=0.8) +
xlab(paste(Traitaxis, "(", ImputedaxisX," by AE)", sep="")) +
ylab(paste(Traitaxis,  "(", ImputedaxisY," by RC)", sep="")) +
scale_color_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f"))
# annotate("text", x=Xp,y=Yp, label = Ssize)
return(p)
}
if(Categorical) {
Outcome <- AE_data[, c("Class", "Best_guess_binomial")]
if(Diet) {
x1 <- AE_data[,c("Best_guess_binomial",TraitName)]; colnames(x1)[2] <- "Primary_diet_AE"
x2 <- RC_data[, c("binomial",TraitName)]; colnames(x2)[2] <- "Primary_diet_RC"
xreturn <- cbind(x1,x2)
xreturn <- xreturn %>%
filter(Primary_diet_AE!=Primary_diet_RC)
}
for (i in 1:nrow(AE_data)){
x <- AE_data[i, TraitName]
y <- RC_data[i, TraitName]
if(is.na(x)|is.na(y)) {Outcome$Result[i] <- "unknown"}
else{
if(x==y) {Outcome$Result[i] <- "same"}
if(x!=y)  { Outcome$Result[i] <- "different"}
}
}
ToPlot <-  with(Outcome, table(Result, Class)) %>%
as.data.frame() %>%
group_by(Class) %>%
mutate(Freq=Freq/sum(Freq)*100) %>%
setNames(., c("outcome", "class", "prop")) %>%
as.data.frame()
# ToPlot <- table(ToPlot) %>%
#   as.data.frame() %>%
#   setNames(., c("outcome", "prop")) %>%
#   mutate(prop=prop/nrow(Outcome)*100)
ToPlot <- ToPlot[order(ToPlot$prop),]
ToPlot$class <- factor(ToPlot$class, levels=c("Aves", "Mammalia"))
if(Comparison) {
if(CompRC_collected) {ImputedaxisX <- "collected RC versus imputed AE"}
if(!CompRC_collected) {ImputedaxisX <- "imputed RC versus collected AE"}
}
if(length(unique(ToPlot$outcome))==3){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(paste(Traitaxis, ImputedaxisX, sep = ", ")) + ylab("% species") +
scale_x_discrete(limits=c("different","unknown", "same"), labels=c("Contradicting","Unknown", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size =7.5,margin = margin(t = 0), hjust=1)))
}
if(length(unique(ToPlot$outcome))==2){
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(paste(Traitaxis, ImputedaxisX, sep = ", ")) + ylab("% species") +
scale_x_discrete(limits=c("different", "same"), labels=c("Contradicting", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size =7.5,margin = margin(t = 0), hjust=1)))
}
# if(!Imputed){
#
#   p <- ggplot(ToPlot, aes(outcome, prop)) +
#     GGPoptions +
#     geom_bar(stat="identity") +
#     xlab(paste(Traitaxis, ImputedaxisX, sep = ", ")) + ylab("% species") +
#     scale_x_discrete(limits=c("different", "unknown", "same"), labels=c("Contradicting", "Unkown", "Similar"))}
if(Diet) {return(list(p=p, outputs=xreturn))}
else{return(p)}
}
}
p <- ggplot(ToPlot, aes(outcome, prop, fill=class)) +
GGPoptions +
geom_bar(stat="identity", position="dodge") +
xlab(paste(Traitaxis, ImputedaxisX, sep = ", ")) + ylab("% species") +
scale_x_discrete(limits=c("different", "same"), labels=c("Contradicting", "Similar")) +
scale_fill_manual(name="Class", labels = c("Birds", "Mammals"), values = c("#268bd2", "#dc322f")) +
theme(legend.position='none') +
ggtitle(paste("mammals:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Mammalia"])),
"\n birds:", length(unique(Outcome$Best_guess_binomial[Outcome$Class=="Aves"])))) +
theme(plot.title = element_text(size =7.5,margin = margin(t = 0), hjust=1))
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/2.Imputations/4.Compare_data_with_RCookeGEB2018.R', echo=TRUE)
source('~/PhD/PhD_analyses/1.Trait_compilation/Code/2.Imputations/4.Compare_data_with_RCookeGEB2018.R', echo=TRUE)
p5
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
#p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE ,"Body_mass_g", FALSE, "BM","imputed","imputed", TRUE, FALSE, FALSE)
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94)),
common.legend = TRUE
)
X <- Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)
Xt <- X$outputs
p5 <- X$p + theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "H")
X2 <- Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)
Xt2 <- X$outputs
p5b <- X2$p + theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "I")
p5 <- ggarrange(p5, p5b)
p <- ggarrange(p3b,p3,p4,p2,p2b, ncol=2, nrow=5, common.legend = TRUE)
p <- ggarrange(p,p5)
p
p5 <- ggarrange(p5, p5b)
p5
p5 <- ggarrange(p5, p5b)
p5
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
#p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE ,"Body_mass_g", FALSE, "BM","imputed","imputed", TRUE, FALSE, FALSE)
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94)),
common.legend = TRUE
)
X <- Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)
Xt <- X$outputs
p5 <- X$p + theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "H")
X2 <- Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)
Xt2 <- X$outputs
p5b <- X2$p + theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "I")
p <- ggarrange(p5, p5b)
p
pb <- ggarrange(p3b,p3,p4,p2,p2b, ncol=2, nrow=5, common.legend = TRUE)
pb
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
#p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE ,"Body_mass_g", FALSE, "BM","imputed","imputed", TRUE, FALSE, FALSE)
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94))
)
p <- ggarrange(p5, p5b, p4)
p
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
#p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE ,"Body_mass_g", FALSE, "BM","imputed","imputed", TRUE, FALSE, FALSE)
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94))
)
p5 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)$p
+ theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "H"),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)$p +
theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "I")
)
p4
p5
pb <- ggarrange(p3b,p3,p4,p2,p2b,p4,p5, ncol=2, nrow=5, common.legend = TRUE)
pb
# Collected RC vs Imputed AE
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94))
)
p5 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)$p
+ theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "H"),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)$p +
theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "I")
)
pb <- ggarrange(p3b,p3,p2,p2b,p4,p5, ncol=2, nrow=5, common.legend = TRUE)
pb
pb <- ggarrange(p3b,p3,p2,p2b,p4,p5, ncol=3, nrow=2, common.legend = TRUE)
pb
p <- ggarange(p4,p5, ncol=2, nrow=2)
p <- ggarrange(p4,p5, ncol=2, nrow=2)
p
p <- ggarrange(p4,p5, ncol=1, nrow=2)
p
pb <- ggarrange(p3b,p3,p2,p2b,p1)
pb
pb <- ggarrange(p3b,p3,p2,p2b,p1, common.legend = TRUE)
pb
pb <- ggarrange(p3b,p3,p2,p2b,p1, common.legend = TRUE, ncol=2, nrow=3)
pb
p <- ggarrange(pb, p, ncol=2, widths = c(1, 1/2))
p
p <- ggarrange(pb, p, ncol=2, widths = c(1/2, 1))
pb <- ggarrange(p3b,p3,p2,p2b,p1, common.legend = TRUE, ncol=2, nrow=3)
p <- ggarrange(p4,p5, ncol=1, nrow=2)
p <- ggarrange(pb, p, ncol=2, widths = c(1/2, 1))
pf <- ggarrange(pb, p, ncol=2, widths = c(1/2, 1))
pf
p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "log10_Body_mass_kg", FALSE, "BM, log10 ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "E") + theme(plot.tag.position = c(0.20, 0.94))
#p1 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE ,"Body_mass_g", FALSE, "BM","imputed","imputed", TRUE, FALSE, FALSE)
p2 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed,  FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, TRUE, FALSE) +
labs(tag = "C") + theme(plot.tag.position = c(0.20, 0.94))
p2b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Litter_size", FALSE, "LCS ", "imputed", "imputed", TRUE, FALSE, FALSE)+
labs(tag = "D") + theme(plot.tag.position = c(0.20, 0.94))
p3 <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, TRUE, FALSE)+ labs(tag = "B") +
theme(plot.tag.position = c(0.20, 0.94))
p3b <- Compare(RC_Collected, RC_Imputed, AE_Collected, AE_Imputed, FALSE, "Habitat_breadth_IUCN", FALSE, "HB ","imputed", "imputed", TRUE, FALSE, FALSE)+ labs(tag = "A") +
theme(plot.tag.position = c(0.20, 0.94))
p4 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed,FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, TRUE, FALSE)+ labs(tag = "F") +
theme(plot.tag.position = c(0.2, 0.94)),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Diel_activity", TRUE, "DA", "imputed","imputed", TRUE, FALSE, FALSE)+ labs(tag = "G")
+ theme(plot.tag.position = c(0.2, 0.94))
)
p5 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)$p
+ theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "H"),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)$p +
theme(plot.tag.position = c(0.95, 0.94))+ labs(tag = "I")
)
pb <- ggarrange(p3b,p3,p2,p2b,p1, common.legend = TRUE, ncol=2, nrow=3)
p <- ggarrange(p4,p5, ncol=1, nrow=2)
pf <- ggarrange(pb, p, ncol=2, widths = c(1/2, 1))
pf
pf <- ggarrange(pb, p, ncol=2, widths = c(1, 1))
p
pf <- ggarrange(pb, p, ncol=2, widths = c(1, 1/2))
pf
pb <- ggarrange(p3b,p3,p2,p2b, common.legend = TRUE, ncol=2, nrow=3)
pb <- ggarrange(p3b,p3,p2,p2b, common.legend = TRUE, ncol=2, nrow=2)
p <- ggarrange(p4,p5, ncol=1, nrow=2)
pf <- ggarrange(pb, p, ncol=2, widths = c(1/2, 1/2))
pf
pff <- ggarrange(pf, p1, nrow=2, heigths=c(1/2,1/2))
pff
p1
pf
ggarrange(pf, p1, nrow=2, heigths=c(1/2,1/2))
pff <- ggarrange(pf, p1, nrow=2)
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(1, 1/2))
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(1, 1/2), common.legend = TRUE)
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(1, 1/2), heights = c(1/2,1/2), common.legend = TRUE)
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(1, 1/2), heights = c(1/2,1/2), common.legend = TRUE)
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(1, 1/2), heights = c(2/3,1/3), common.legend = TRUE)
pff
ggplot(mtcars, aes(x = wt, y = mpg)) + geom_blank()
ggplot(mtcars, aes(x = wt, y = mpg)) + geom_blank() + theme_classic()
ggplot(mtcars, aes(x = wt, y = mpg)) + geom_blank() + theme_classic() + theme(element_text(colour="white"))
ggplot(mtcars, aes(x = wt, y = mpg)) + geom_blank() + theme_classic() + theme(element_text(colour = "white"))
pff
pff <- ggarrange(pf, p1, nrow=2, widths = c(3/4, 1/4), heights = c(2/3,1/3), common.legend = TRUE)
pff
