library(reshape)
library(ggplot2)
library(dplyr)
library(ggpubr)
source("Functions_for_results_congruence.R")
## Load imputed datasets (8); retrieve errors
Imputed <- readRDS("../../Results/2.Imputed_trait_datasets/Imputed_not_standardised/List_of_8_sets.rds")
## Amphibians
Amphibians <- Get_all_results(Imputed, "A")$Errors
str(Amphibians)
Errors_amp <- data.table::rbindlist(Amphibians)
View(Errors_amp)
Errors_bir <- data.table::rbindlist(Birds)
Reptiles <- Get_all_results(Imputed, "R")$Errors
Errors_rep <- data.table::rbindlist(Reptiles)
View(Errors_rep)
?missForest
library(missForest)
?missForest
## Mammals
Mammals <- Get_all_results(Imputed, "M")$Errors
Errors_mam <- data.table::rbindlist(Mammals)
Birds <- Get_all_results(Imputed, "B")$Errors
Errors_bir <- data.table::rbindlist(Birds)
View(Errors_mam)
Cattraits <- c("Trophic_level", "Diel_activity", "Specialisation", "Primary_diet")
PFC_amp <- Errors_amp[,grepl(Cattraits, colnames(Errors_amp))]
PFC_amp <- Errors_amp[, colnames(PFC_amp %in% Cattraits)]
colnames(Errors_amp)
PFC_amp <- Errors_amp[, colnames(PFC_amp %in% paste(Cattraits, "PFC", sep=" "))]
paste(Cattraits, "PFC", sep=" ")
colnames(PFC_amp %in% paste(Cattraits, "PFC", sep=" "))
PFC_amp <- Errors_amp[, colnames(Errors_amp %in% paste(Cattraits, "PFC", sep=" "))]
colnames(Errors_amp %in% paste(Cattraits, "PFC", sep=" "))
Errors_amp
PFC_amp <- Errors_amp[, colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" ")]
colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" ")
which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
Y <- which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
PFC_amp <- Errors_amp[,Y]
Y <- which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
Y
Errors_amp
PFC_amp <- Errors_amp[,Y]
Errors_amp <- data.table::rbindlist(Amphibians) %>% as.data.frame()
Y <- which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
PFC_amp <- Errors_amp[,Y]
View(PFC_amp)
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/2.Imputations/6.Imputation_errors.R')
boxplot(PFC_amp$`Diel_activity PFC`)
hist(PFC_amp$`Diel_activity PFC`)
boxplot(PFC_amp$`Diel_activity PFC`)
boxplot(PFC_amp$`Diel_activity PFC`. ylim=c(0,100))
boxplot(PFC_amp$`Diel_activity PFC`, ylim=c(0,100))
PFC_amp <- Errors_amp[,Y]*100
boxplot(PFC_amp$`Diel_activity PFC`, ylim=c(0,100))
library(reshape)
PFC_amp <- melt(PFC_amp)
View(PFC_amp)
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean())
PFC_amp %>% group_by(variable)
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
PFC_amp
Y <- which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
PFC_amp <- Errors_amp[,Y]*100
PFC_amp["Mean", ] <- apply(PFC_amp, 2, mean)
PFC_amp <-melt(PFC_amp)
View(PFC_amp)
PFC_amp <-melt(PFC_amp)
PFC_amp <- Errors_amp[,Y]*100
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
PFC_amp
# Categorical
Y <- which(colnames(Errors_amp) %in% paste(Cattraits, "PFC", sep=" "))
PFC_amp <- Errors_amp[,Y]*100
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
PFC_amp
PFC_amp <- melt(PFC_amp)
PFC_amp <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
PFC_amp
plot(PFC_amp$variable, PFC_amp$Mean)
PFC_amp <- Errors_amp[,Y]*100
PFC_amp <- melt(PFC_amp)
PFC_amp_means <- PFC_amp %>% group_by(variable) %>% summarise(Mean=mean(value))
plot(PFC_amp$variable, PFC_amp$Mean)
PFC_amp
ggplot(PFC_amp, aes(variable, value)) + geom_point()
ggplot(PFC_amp, aes(variable, value)) + geom_point() + ylim(0,100)
ggplot(PFC_amp, aes(variable, value)) + geom_point() + ylim(0,100) +
geom_point(aes(PFC_amp_means$variable, PFC_amp_means$Mean))
ggplot(PFC_amp, aes(variable, value)) + geom_point() + ylim(0,100)
