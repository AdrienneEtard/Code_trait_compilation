p5 <- ggarrange(
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, TRUE, TRUE)$p
+ theme(plot.tag.position = c(0.25, 0.94))+ labs(tag = "H"),
Compare(RC_Collected, RC_Imputed,  AE_Collected, AE_Imputed, FALSE, "Primary_diet", TRUE, "PD", "imputed","imputed", TRUE, FALSE, TRUE)$p +
theme(plot.tag.position = c(0.25, 0.94))+ labs(tag = "I")
)
p <- ggarrange(p3b,p3,p4,p2,p2b,p5,p1, common.legend = TRUE, widths = c(1/4,1/4, 1/2))
ggsave(p, file="../../Results/Plots/Comparison_with_RCooke/Comparison_imputed_VS_collected.pdf", width =13, height =9)
# Read trait data
Mammals <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Mammals.csv")
Birds <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Birds.csv")
Amphibians <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Amphibians.csv")
Reptiles <- read.csv("../../Results/1.Traits_before_imputations/With_taxonomic_correction/All_species/3.with_phylo_eigenvectors/Reptiles.csv")
plot(density(Mammals$Adult_svl_cm))
plot(density(Mammals$Adult_svl_cm, na.rm=T))
plot(density(log10(Mammals$Adult_svl_cm), na.rm=T))
plot(density(Mammals$Generation_length_d, na.rm=T))
plot(density(log10(Mammals$Generation_length_d), na.rm=T))
plot(density(Mammals$Body_mass_g, na.rm=T))
plot(density(log10(Mammals$Body_mass_g), na.rm=T))
plot(density(Mammals$Litter_size, na.rm=T))
plot(density(log10(Mammals$Litter_size), na.rm=T))
plot(density(Mammals$Litter_size, na.rm=T))
plot(density(Mammals$Diet_breadth, na.rm=T))
plot(density(log10(Mammals$Diet_breadth), na.rm=T))
plot(density(Mammals$Range_size_m2, na.rm=T))
plot(density(log10(Mammals$Range_size_m2), na.rm=T))
plot(density(log10(Mammals$Habitat_breadth_IUCN), na.rm=T))
plot(density(Mammals$Habitat_breadth_IUCN, na.rm=T))
plot(density(log10(Mammals$Habitat_breadth_IUCN), na.rm=T))
# Traits
Continuous.Traits <- c("Body_mass_g",
"Longevity_d",
"Litter_size",
"Diet_breadth",
"Range_size_m2",
"Habitat_breadth_IUCN")
Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")]
plot(density(Mammals$Habitat_breadth_IUCN, na.rm=T))
plot(density(log10(Mammals$Habitat_breadth_IUCN), na.rm=T))
plot(density(sqrt(Mammals$Habitat_breadth_IUCN), na.rm=T))
# log-transform continuous traits
Mammals[, c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm")] %<>% log10()
library(dplyr)
# log-transform continuous traits
Mammals[, c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm")] %<>% log10()
log10(Mammals[, c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm")])
Mammals[, c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm")]
Mammals <- Transf(Mammals, Traits_log10 =c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm"))
# log-transform continuous traits
Transf <- function(Data, Traits_log10) {
Data[, Traits_log10] <- log10(Data[, Traits_log10])
Data$Habitat_breadth_IUCN <- sqrt(Data$Habitat_breadth_IUCN)
return(Data)
}
Mammals <- Transf(Mammals, Traits_log10 =c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d", "Adult_svl_cm"))
plot(density(Mammals$Habitat_breadth_IUCN, na.rm=T))
plot(density(Mammals$Body_mass_g, na.rm=T))
plot(density(sqrt(Birds$Habitat_breadth_IUCN), na.rm=T))
plot(density(Birds$Body_mass_g, na.rm=T))
plot(density(log10(Birds$Body_mass_g), na.rm=T))
Birds <- Transf(Birds, Traits_log10 =c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Generation_length_d"))
plot(density(Birds$Body_mass_g, na.rm=T))
Amphibians <- Transf(Amphibians, Traits_log10=c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Body_length_mm"))
Reptiles <- Transf(Reptiles, Traits_log10=c(Continuous.Traits[-which(Continuous.Traits=="Habitat_breadth_IUCN")],"Adult_svl_cm", "Maturity_d"))
Reptiles <- Transf(Reptiles, Traits_log10=c("Body_mass_g","Longevity_d","Litter_size","Adult_svl_cm", "Range_size_m2","Maturity_d"))
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/2.Imputations/3.Assess_phylo_signal_corrected_trees.R', echo=TRUE)
Lambda_Mammals_continuous
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/2.Imputations/4.Assess_phylo_signal_original_trees.R', echo=TRUE)
library(gmodels)
library(ggplot2)
library(dplyr)
library(boot)
library(ggpubr)
## Function to plot the distribution of null values, calculate mean and 95% CI for all categorical traits
Comparison_null_dist <- function(List, Catraits) {
# Dataset of observed signal
Delta <- vector()
for (i in 1:length(Catraits)) {
Delta <- c(Delta, List[[Catraits[i]]][1]) %>%
as.data.frame() %>%
t
}
rownames(Delta) <- Catraits
colnames(Delta) <- "delta_obs"
Delta <- as.data.frame(Delta)
# Add simulation means and 95% CI
n <- List[[Catraits[1]]][2]$Delta0 %>% nrow
Simulations <- as.data.frame(matrix(nrow=n, ncol=length(Catraits)))
colnames(Simulations) <- Catraits
for (i in 1:length(Catraits)) {
Sim <- List[[Catraits[i]]][2]$Delta0 %>% as.vector()
colnames(Sim) <- "Simulated"
Delta$MedianSim[i] <- median(Sim$Simulated, na.rm=TRUE)
# 95% ci for the median (bootstrapping)
bootmed <- apply(matrix(sample(Sim$Simulated, rep=TRUE, 10^5*length(Sim$Simulated)), nrow=10^5), 1, median, na.rm=TRUE)
X <- quantile(bootmed, c(.025, 0.975), na.rm=TRUE)
Delta$CI_up[i] <- X[2]
Delta$CI_low[i]<- X[1]
Simulations[,i] <- Sim
}
return(list(Delta, Simulations))
}
## Function to plot results for categorical traits
Plot_Delta <- function(Delta) {
GGPoptions <- theme_classic() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=13),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=13),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
Delta$Trait <- rownames(Delta)
p <- ggplot(Delta, aes(Trait, delta_obs)) +
geom_point() +
geom_point(aes(Trait, MedianSim), col="blue") +
geom_errorbar(aes(ymin=CI_low, ymax=CI_up), width=0.3, col="blue") +
scale_y_continuous(trans="log10") +
GGPoptions
return(p)
}
## Function to plot results for categorical traits (delta) for both original and corrected phylogenies
Plot_Delta_All <- function(Delta) {
Delta$Phylogeny <- factor(Delta$Phylogeny, levels=c("Original", "Modified"))
GGPoptions <- theme_bw() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=13),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=13),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
p <- ggplot(Delta, aes(Trait, delta_obs, group=Phylogeny, col=Phylogeny)) +
geom_point(position = position_dodge(width=0.2), shape=24, aes(fill=Phylogeny)) +
geom_point(aes(Trait, MedianSim), position = position_dodge(width=0.2)) +
geom_errorbar(aes(ymin=CI_low, ymax=CI_up), width=0.1, position = position_dodge(width=0.2)) +
scale_y_continuous(trans="log10") +
ylab(expression(delta)) +
GGPoptions
return(p)
}
## Function to plot results for continuous traits (lambda) for both original and corrected phylogenies
Plot_Lambda_All <- function(Lambda_c, Lambda_o) {
Lambda <- rbind(Lambda_c, Lambda_o)[c(1,5),]
Lambda<- reshape::melt(Lambda)
Lambda$Phylogeny <- factor(Lambda$Phylogeny, levels=c("Original", "Modified"))
GGPoptions <- theme_bw() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=13),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=13),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
p <- ggplot(Lambda, aes(variable, value, group=Phylogeny, col=Phylogeny)) +
geom_point(shape=24, aes(fill=Phylogeny), alpha=0.8) + #position = position_dodge(width=0.2),
geom_hline(yintercept= 0.9, linetype="dashed") +
#scale_y_continuous(trans="log10", breaks = c(0.7,0.8,0.9,1)) +
ylab(expression(lambda)) +
GGPoptions
return(p)
}
## Function to run Wilcoxon Rank Sum and Signed rank tests
## Testing whether the observed median is significantly different from the null distribution for phylogenetic signal in categorcial traits
Wilcox_Test <- function(Simulations, Delta) {
Delta <- Delta %>%
select(delta_obs)
for (i in 1:nrow(Delta)) {
Delta$W_pvalue[i] <- wilcox.test(Simulations[,i], mu=Delta$delta_obs[i], alternative="less")["p.value"] %>% as.numeric()
Delta$W_statistic[i] <- wilcox.test(Simulations[,i], mu=Delta$delta_obs[i], alternative="less")["statistic"]%>% as.numeric()
}
return(Delta)
}
Mammals_c <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/CategoricalMammals.rds")
Birds_c <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/CategoricalBirds.rds")
Reptiles_c <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/CategoricalReptiles.rds")
Amphibians_c <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/CategoricalAmphibians.rds")
# with original tree -- categorical
Mammals_o <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/CategoricalMammals.rds")
Birds_o <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/CategoricalBirds.rds")
Reptiles_o <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/CategoricalReptiles.rds")
Amphibians_o <- readRDS("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/CategoricalAmphibians.rds")
Lambda_M_c <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousMammals_log.csv")
Lambda_B_c <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousBirds_log.csv")
Lambda_R_c <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousReptiles_log.csv")
Lambda_A_c <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousAmphibians_log.csv")
Lambda_M_o <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Lambda_B_o <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Lambda_R_o <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Lambda_A_o <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Lambda_B_c$Class <- "Birds"
Lambda_B_c$Phylogeny <- "Modified"
Lambda_M_c$Class <- "Mammals"
Lambda_M_c$Phylogeny <- "Modified"
Lambda_R_c$Class <- "Reptiles"
Lambda_R_c$Phylogeny <- "Modified"
Lambda_A_c$Class <- "Amphibians"
Lambda_A_c$Phylogeny <- "Modified"
Lambda_B_o$Class <- "Birds"
Lambda_B_o$Phylogeny <- "Original"
Lambda_M_o$Class <- "Mammals"
Lambda_M_o$Phylogeny <- "Original"
Lambda_R_o$Class <- "Reptiles"
Lambda_R_o$Phylogeny <- "Original"
Lambda_A_o$Class <- "Amphibians"
Lambda_A_o$Phylogeny <- "Original"
pCont <- ggarrange(
Plot_Lambda_All(Lambda_M_c, Lambda_M_o) + scale_x_discrete(labels=c("BM", "L", "LCS", "DB", "RS", "HB", "GL", "BL")) + xlab("")+
labs(tag = "A") + theme(plot.tag.position ="topleft"),
Plot_Lambda_All(Lambda_B_c, Lambda_B_o) + scale_x_discrete(labels=c("BM", "L", "LCS", "DB", "RS", "HB", "GL")) + xlab("") + ylab("")+
labs(tag = "B") + theme(plot.tag.position ="topleft"),
Plot_Lambda_All(Lambda_R_c, Lambda_R_o) + scale_x_discrete(labels=c("BM", "L", "LCS", "RS", "HB", "BL", "SM"))+ xlab("")+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Lambda_All(Lambda_A_c, Lambda_A_o) + scale_x_discrete(labels=c("BM", "L", "LCS", "DB", "RS", "HB", "BL"))+ xlab("") + ylab("")+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend=TRUE, legend="right"
)
pCont
ggsave(pCont, filename="../../Results/Plots/Phylosignal/Continuous.pdf", width=8, height=6)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv") %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv") %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
View(ModifiedAmphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
ModifiedAmphibians  <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
View(ModifiedAmphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
View(ModifiedAmphibians)
ModifiedAmphibians  <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
View(ModifiedAmphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
rownames(Amphibians) <- colnames(ModifiedAmphibians)
View(Amphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=rownames(ModifiedAmphibians), Phylogeny="Modified")
rownames(ModifiedAmphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
rownames(ModifiedAmphibians)
View(ModifiedAmphibians)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
View(Amphibians)
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
View(Birds)
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
View(Mammals)
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
View(ModifiedReptiles)
View(Reptiles)
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
View(PhyContModified)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value")]
View(PhyContModified)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
View(PhyContModified)
PhyContModified <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse("Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length", Trait))))))))))
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
View(PhyContModified)
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse("Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length", Trait))))))))))
View(test)
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse("Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length")))))))))))
View(test)
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse("Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
View(test)
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
View(test)
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_original.csv", row.names = FALSE)
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_modified.csv", row.names = FALSE)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousAmphibians_log.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousBirds_log.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousMammals_log.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousReptiles_log.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_modified.csv", row.names = FALSE)
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousAmphibians_log.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousBirds_log.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousMammals_log.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousReptiles_log.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
test <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousAmphibians_log.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousBirds_log.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousMammals_log.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_corrected_phylogenies/ContinuousReptiles_log.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
PhyContModified <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_modified.csv", row.names = FALSE)
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Modified")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Modified")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Modified")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Modified")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
PhyContModified <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_original.csv", row.names = FALSE)
library(dplyr)
ModifiedAmphibians <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousAmphibians_log10.csv")
Amphibians <- ModifiedAmphibians  %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value")) %>% mutate(Class="Amphibians")
Amphibians <- Amphibians %>% mutate(Trait=colnames(ModifiedAmphibians), Phylogeny="Original")
ModifiedBirds <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousBirds_log10.csv")
Birds <- ModifiedBirds %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Birds", Trait=colnames(ModifiedBirds), Phylogeny="Original")
ModifiedMammals <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousMammals_log10.csv")
Mammals <- ModifiedMammals %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Mammals", Trait=colnames(ModifiedMammals), Phylogeny="Original")
ModifiedReptiles <- read.csv("../../Results/1.Traits_before_imputations/Phylogenetic_signal/with_original_phylogenies/ContinuousReptiles_log10.csv")
Reptiles <- ModifiedReptiles %>%
t() %>% as.data.frame()%>% select(c(1,4)) %>% setNames(c("lambda", "p-value"))%>% mutate(Class="Reptiles", Trait=colnames(ModifiedReptiles), Phylogeny="Original")
PhyContModified <- rbind(Birds, Reptiles, Mammals, Amphibians)
PhyContModified <- PhyContModified[, c("Class", "Trait", "lambda", "p-value", "Phylogeny")]
PhyContModified <- PhyContModified %>% mutate(Trait=ifelse(Trait=="Body_mass_g", "Body mass",
ifelse(Trait=="Longevity_d", "Longevity",
ifelse(Trait=="Litter_size", "Litter/clutch size",
ifelse(Trait=="Diet_breadth", "Diet breath",
ifelse(Trait=="Range_size_m2", "Range size",
ifelse(Trait=="Habitat_breadth_IUCN", "Habitat breadth",
ifelse(Trait=="Generation_length_d", "Generation length",
ifelse(Trait=="Maturity_d", "Maturity",
ifelse(Trait=="Adult_svl_cm", "Body length",
ifelse(Trait=="Body_length_mm", "Body length", Trait)))))))))))
write.csv(PhyContModified, "../../Results/1.Traits_before_imputations/Phylogenetic_signal/Continuous_traits_significance_chisquared_original.csv", row.names = FALSE)
