common.legend = TRUE, widths=c(0.555,0.445), legend="right")
ggsave(p, file="../../Results/Plots/Imputation_errors/MSE_PFC.pdf", width=8.5, height=3)
View(Amphibians)
## Distributions for continuous traits
i <- sample(1:8, 1)
i
## Distributions for continuous traits
i <- sample(1:8, 1)
i
All_traits <- rbind(Amphibians[[i]], Mammals[[i]], Reptiles[[i]], Birds[[i]])
Amphibians[[i]]
Amphibians
A <- Get_all_results(Imputed, "A")
A
str9A
str(A)
View(A)
A <- Get_all_results(Imputed, "A")$Results
A
A <- Get_all_results(Imputed, "A")$Results[[i]]
All_traits <- rbind(
Get_all_results(Imputed, "A")$Results[[i]],
Get_all_results(Imputed, "M")$Results[[i]],
Get_all_results(Imputed, "R")$Results[[i]],
Get_all_results(Imputed, "B")$Results[[i]])
ggplot(All_traits, aes(Body_mass_g, Class)) + geom_density()
ggplot(All_traits, aes(Body_mass_g, Class)) + geom_density(col=Class)
ggplot(All_traits, aes(Body_mass_g,)) + geom_density(aes(col=Class))
ggplot(All_traits, aes(Body_mass_g)) + geom_density(aes(col=Class))
ggplot(All_traits, aes(Body_mass_g)) + geom_density()
ggplot(All_traits, aes(Body_mass_g)) + geom_density() + scale_y_continuous(trans = "log10")
ggplot(All_traits, aes(Body_mass_g)) + geom_density() + scale_x_continuous(trans = "log10")
ggplot(All_traits, aes(Body_mass_g)) + geom_density(adjust=10)
ggplot(All_traits, aes(Body_mass_g)) + geom_density(adjust=10) + scale_x_continuous(trans = "log10")
ggplot(All_traits, aes(Body_mass_g)) + geom_density(adjust=10) + scale_x_continuous(trans = "log10", labels=scales::format)
ggplot(All_traits, aes(Body_mass_g)) + geom_density(adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(col=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(col=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma, breaks=c(0,0.1,10,10000))
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(col=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_histogram(aes(col=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_histogram(aes(fill=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(fill=Class), adjust=10) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(fill=Class), adjust=10, alpha=0.7) + scale_x_continuous(trans = "log10", labels=scales::comma)
ggplot(All_traits, aes(Body_mass_g/1000)) + geom_density(aes(fill=Class), adjust=10, alpha=0.5) + scale_x_continuous(trans = "log10", labels=scales::comma)
+ scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions
## Distributions for continuous traits
GGPoptions <- theme_bw() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=12),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=12),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
ggplot(All_traits, aes(Body_mass_g/1000))
+ geom_density(aes(fill=Class), adjust=10, alpha=0.5)
+ scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.5) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions
## Distributions for continuous traits
GGPoptions <- theme_classic() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=12),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=12),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.5) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("BM (kg)")
All_traits$Class <- factor(All_traits$Class, levels=c("Amphibia", "Aves", "Mammalia", "Reptilia"), labels=c("Amphibians", "Mammals","Reptiles", "Birds"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("BM (kg)")
All_traits$Class <- factor(All_traits$Class, levels=c("Amphibia", "Aves", "Mammalia", "Reptilia"), labels=c("Amphibians", "Birds","Mammals", "Reptiles"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("BM (kg)")
All_traits$Class <- factor(All_traits$Class, levels=c("Amphibia", "Aves", "Mammalia", "Reptilia"), labels=c("Amphibians", "Birds","Mammals", "Reptiles"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("BM (kg)")
All_traits$Class
i <- sample(1:8, 1)
All_traits <- rbind(
Get_all_results(Imputed, "A")$Results[[i]],
Get_all_results(Imputed, "M")$Results[[i]],
Get_all_results(Imputed, "R")$Results[[i]],
Get_all_results(Imputed, "B")$Results[[i]])
All_traits$Class
All_traits$Class <- factor(All_traits$Class, levels=c("Amphibia", "Aves", "Mammalia", "Reptilia"), labels=c("Amphibians", "Birds","Mammals", "Reptiles"))
All_traits$Class
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("BM (kg)")
ggplot(All_traits, aes(Litter_size/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
#scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("LCS (kg)")
ggplot(All_traits, aes(Litter_size/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab("LCS")
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM"*log_10))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"*[10]))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"[10]))
ggplot(All_traits, aes(Litter_size/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"[10]"kg"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"[10]*"kg"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"[10]*" (kg)"))
ggplot(All_traits, aes(Longevity/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
PlotMSE <- function(MSEErrors) {
GGPoptions <- theme_bw() + theme(
panel.border = element_rect(colour = "black", fill=NA),
text = element_text(size=13, family="serif"),
axis.text.x = element_text(color="black", margin=ggplot2::margin(10,0,2,0,"pt"), size=12),
axis.text.y = element_text(color="black", margin=ggplot2::margin(0,10,0,0,"pt"), size=12),
axis.ticks.length=unit(-0.1, "cm"),
legend.text=element_text(size=13))
MSE <- melt(MSEErrors)
MSE <- MSE %>% group_by(Class, variable) %>%
summarise(Mean=mean(value, na.rm=TRUE),
Max=max(value, na.rm = TRUE),
Min=min(value, na.rm = TRUE))
MSE$Max[23] <- NA
MSE$Min[23] <- NA
p <- ggplot(MSE, aes(variable, Mean, col=Class)) + GGPoptions +
geom_point() +
scale_x_discrete(labels=c("BM (kg)", "L (years)", "LCS", expression("RS (mega-m"^2*")"), "DB", "HB")) +
scale_y_continuous(labels=c(0.1,1,10,100,1000), breaks=c(0.1,1,10,100,1000), trans="log10") +
geom_segment(aes(x=variable, xend=variable, y=MSE$Min, yend=MSE$Max, col=Class)) +
xlab("") + ylab(expression(sqrt("OOB mean-square error"))) + coord_flip()
return(p)
}
## Plot MSE for all classes
pMSE <- PlotMSE(MSE_all)
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, widths=c(0.555,0.445), legend="right")
ggsave(p, file="../../Results/Plots/Imputation_errors/MSE_PFC.pdf", width=8.5, height=3)
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2]))
ggplot(All_traits, aes(Diet_breadth)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
# scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Diet_breadth)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Diet_breadth)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Diet_breadth)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Diet_breadth)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "sqrt", labels=scales::comma) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2]))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2])) + xlim(c(0,100000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2])) + xlim(c(0,10000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2])) + xlim(c(0,1000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"[2]*")")) + xlim(c(0,1000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"^2*")")) + xlim(c(0,1000000))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("LCS, log"[10])) + xlim(c(0,15000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
#scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, log"[10]*" (km"^2*")")) + xlim(c(0,1000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
#scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS, km"^2*")")) + xlim(c(0,1000000))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
#scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
p
DBM <- ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma) +
GGPoptions + xlab(expression("BM, log"[10]*" (kg)"))
DBM
DBM <- ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::comma, digits=2) +
GGPoptions + xlab(expression("BM, log"[10]*" (kg)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.01, decimal.mark = ',')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.01, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.01, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.01, decimal.mark = '.')) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 1, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.1, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.1, decimal.mark = '.')) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.1, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.1, decimal.mark = '.')) +
GGPoptions + xlab(expression("BM, log"[10]*" (kg)"))
DBM <- ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions + xlab(expression("BM, log"[10]*" (kg)"))
DBM
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(accuracy = 0.1, decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("LCS, log"[10]))
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
DL <- ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("L, log"[10]*" (years)"))
DLCS <- ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("LCS, log"[10]))
DRS<- ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DBM  + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "D") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "E") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "F") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, widths=c(0.555,0.445), legend="right")
p
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DBM  + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "D") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "E") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "F") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, widths=c(0.555,0.445), legend="right",
ncol=2)
p
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DBM  + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "D") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "E") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "F") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, widths=c(0.555,0.445), legend="right",
ncol=2, nrow=6)
p
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DBM  + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "D") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "E") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "F") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, widths=c(0.555,0.445), legend="right",
ncol=2, nrow=3)
p
p <- ggarrange(pMSE + labs(tag = "A") + theme(plot.tag.position = "topleft"),
pPFC + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DBM  + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "D") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "E") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "F") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right",
ncol=2, nrow=3)
p
p <- ggarrange(
DBM  + labs(tag = "A") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right",
ncol=2, nrow=2)
p
DRS <- ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
p <- ggarrange(
DBM  + labs(tag = "A") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right",
ncol=2, nrow=2)
p
ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("RS (km"^2*")")) + xlim(c(0,1000000))
DRS <- ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("RS (km"^2*")"))
DRS
p <- ggarrange(
DBM  + labs(tag = "A") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right",
ncol=2, nrow=2)
p
ggsave(p, file="../../Results/Plots/Imputation_errors/Distributions.pdf", width=8.5, height=3)
ggsave(p, file="../../Results/Plots/Imputation_errors/Distributions.pdf", width=6, height=4)
ggsave(p, file="../../Results/Plots/Imputation_errors/Distributions.pdf", width=8, height=6)
DBM <- ggplot(All_traits, aes(Body_mass_g/1000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions + xlab(expression("BM (kg)"))
DL <- ggplot(All_traits, aes(Longevity_d/365.25)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("L (years)"))
DLCS <- ggplot(All_traits, aes(Litter_size)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("LCS, log"))
DRS <- ggplot(All_traits, aes(Range_size_m2/1000000)) +
geom_density(aes(fill=Class), adjust=10, alpha=0.3) +
scale_x_continuous(trans = "log10", labels=scales::number_format(decimal.mark = '.')) +
GGPoptions  + xlab(expression("RS (km"^2*")"))
p <- ggarrange(
DBM  + labs(tag = "A") + theme(plot.tag.position = "topleft"),
DL + labs(tag = "B") + theme(plot.tag.position = "topleft"),
DLCS + labs(tag = "C") + theme(plot.tag.position = "topleft"),
DRS  + labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right",
ncol=2, nrow=2)
p
ggsave(p, file="../../Results/Plots/Imputation_errors/Distributions.pdf", width=8, height=6)
ggsave(p, file="../../Results/Plots/Imputation_errors/Distributions.pdf", width=8, height=6)
source('~/PhD/PhD_R_work/1.Trait_compilation/Code/2.Imputations/5.Physignal_plots_test_significance_cat.R', echo=TRUE)
pCat
pCat <- ggarrange(
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Mammals",]) + xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL")) +
labs(tag = "A") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Birds",])+ xlab("") + ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "B") + theme(plot.tag.position = "topleft") + scale_y_continuous( labels=scales::number_format(decimal.mark = '.')),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Reptiles",])+ xlab("") + scale_x_discrete(transf="log10", labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Amphibians",])+ xlab("")+ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right"
)
pCat <- ggarrange(
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Mammals",]) + xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL")) +
labs(tag = "A") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Birds",])+ xlab("") + ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "B") + theme(plot.tag.position = "topleft") + scale_y_continuous(transf="log10", labels=scales::number_format(decimal.mark = '.')),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Reptiles",])+ xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Amphibians",])+ xlab("")+ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right"
)
pCat <- ggarrange(
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Mammals",]) + xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL")) +
labs(tag = "A") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Birds",])+ xlab("") + ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "B") + theme(plot.tag.position = "topleft") + scale_y_continuous(trans="log10", abels=scales::number_format(decimal.mark = '.')),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Reptiles",])+ xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Amphibians",])+ xlab("")+ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right"
)
pCat
pCat <- ggarrange(
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Mammals",]) + xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL")) +
labs(tag = "A") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Birds",])+ xlab("") + ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "B") + theme(plot.tag.position = "topleft") + scale_y_continuous(trans="log10", labels=scales::number_format(decimal.mark = '.')),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Reptiles",])+ xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Amphibians",])+ xlab("")+ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right"
)
pCat
pCat <- ggarrange(
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Mammals",]) + xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL")) +
labs(tag = "A") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Birds",])+ xlab("") + ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "B") + theme(plot.tag.position = "topleft") + scale_y_continuous(trans="log10", labels=scales::number_format(decimal.mark = '.', accuracy = 0.01)),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Reptiles",])+ xlab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "C") + theme(plot.tag.position = "topleft"),
Plot_Delta_All(Cat_signal_all[Cat_signal_all$Class=="Amphibians",])+ xlab("")+ylab("") + scale_x_discrete(labels=c("DA", "PD", "Sp", "TL"))+
labs(tag = "D") + theme(plot.tag.position = "topleft"),
common.legend = TRUE, legend="right"
)
pCat
ggsave(pCat, filename="../../Results/Plots/Phylosignal/Categorical.pdf", width=8, height=6)
